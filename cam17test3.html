<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Academic Test Simulator - Cambridge 17 Test 3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none;
        }
        .ielts-container {
            display: grid;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
        }
        .content-panes {
            display: grid;
            grid-template-columns: 1fr 5px 1fr;
            overflow: hidden;
        }
        .pane {
            overflow-y: auto;
            padding: 1.5rem;
        }
        .splitter {
            background-color: #d1d5db;
            cursor: col-resize;
            z-index: 10;
        }
        .tab-btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background-color: #f9fafb;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab-btn:hover {
            background-color: #f3f4f6;
        }
        .tab-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .section-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background-color: #f9fafb;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 4px;
        }
        .section-btn:hover {
            background-color: #e5e7eb;
        }
        .section-btn.active {
            background-color: #1d4ed8;
            color: white;
            border-color: #1d4ed8;
        }
        input[type="text"] {
            border: 1px solid #9ca3af;
            border-radius: 4px;
            padding: 4px 8px;
            width: 150px;
        }
        input[type="text"]:focus {
            outline: 2px solid #3b82f6;
            border-color: #3b82f6;
        }
        .reading-passage {
            line-height: 1.8;
            font-size: 16px;
            color: #374151;
            text-align: justify;
            margin-bottom: 2rem;
        }
        .reading-passage p {
            margin-bottom: 1.5rem;
        }
         .reading-passage h3, .reading-passage h4 {
            color: #1f2937;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        .explanation-box {
            animation: fadeIn 0.3s ease-in-out;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .explanation-box:hover {
            background-color: #dbeafe !important;
            transform: scale(1.02);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .correct-answer {
            box-shadow: 0 0 0 2px #16a34a;
        }
        .incorrect-answer {
            box-shadow: 0 0 0 2px #dc2626;
        }
        .highlight-tooltip {
            position: absolute;
            background-color: #1f2937;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 100;
            cursor: pointer;
            display: none;
        }
        mark {
            background-color: #fef08a;
            border-radius: 2px;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div id="test-container" class="ielts-container">
    <!-- Header -->
    <header class="bg-white shadow-md p-3 flex justify-between items-center">
        <h1 class="text-xl font-bold text-blue-600">IELTS Academic Test Simulator - Cambridge 17 Test 3</h1>
        <div class="flex items-center space-x-4">
            <div class="text-lg font-semibold text-gray-600">IELTS Academic Reading</div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="content-panes" class="content-panes">
        <!-- Left Pane: Passages / Instructions -->
        <div id="left-pane" class="pane bg-white">
            <!-- Content will be loaded here by JS -->
        </div>

        <!-- Splitter -->
        <div id="splitter" class="splitter"></div>

        <!-- Right Pane: Questions -->
        <div id="right-pane" class="pane bg-gray-50">
            <div id="questions-section" class="questions-section">
                <!-- Questions will be loaded here by JS -->
            </div>
        </div>
    </main>

    <!-- Footer: Navigation -->
    <footer class="bg-white shadow-inner p-3">
        <div class="flex justify-between items-center">
            <!-- Main Skill Tabs -->
            <div>
                <button class="tab-btn active" data-tab="reading">Reading</button>
            </div>
            <!-- Section Tabs -->
            <div id="section-tabs">
                <!-- Section buttons will be loaded here by JS -->
            </div>
        </div>
    </footer>
</div>

<!-- Highlight Tooltip -->
<div id="highlight-tooltip" class="highlight-tooltip">Highlight</div>


<script>
    // --- DATA ---
    const testData = {
        reading: {
            duration: 3600, // 60 minutes
            sections: [
                {
                    title: "Passage 1",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">The thylacine</h3>
                        <p>The extinct thylacine, also known as the Tasmanian tiger, was a marsupial* that bore a superficial resemblance to a dog. Its most distinguishing feature was the 13-19 dark brown stripes over its back, beginning at the rear of the body and extending onto the tail. The thylacine’s average nose-to-tail length for adult males was 162.6 cm, compared to 153.7 cm for females.</p>
                        <p>The thylacine appeared to occupy most types of terrain except dense rainforest, with open eucalyptus forest thought to be its prime habitat. In terms of feeding, it was exclusively carnivorous, and its stomach was muscular with an ability to distend so that it could eat large amounts of food at one time, probably an adaptation to compensate for long periods when hunting was unsuccessful and food scarce. The thylacine was not a fast runner and probably caught its prey by exhausting it during a long pursuit. During long-distance chases, thylacines were likely to have relied more on scent than any other sense. They emerged to hunt during the evening, night and early morning and tended to retreat to the hills and forest for shelter during the day. Despite the common name ‘tiger’, the thylacine had a shy, nervous temperament. Although mainly nocturnal, it was sighted moving during the day and some individuals were even recorded basking in the sun.</p>
                        <p>The thylacine had an extended breeding season from winter to spring, with indications that some breeding took place throughout the year. The thylacine, like all marsupials, was tiny and hairless when born. Newborns crawled into the pouch on the belly of their mother, and attached themselves to one of the four teats, remaining there for up to three months. When old enough to leave the pouch, the young stayed in a lair such as a deep rocky cave, well-hidden nest or hollow log, whilst the mother hunted.</p>
                        <p>Approximately 4,000 years ago, the thylacine was widespread throughout New Guinea and most of mainland Australia, as well as the island of Tasmania. The most recent, well-dated occurrence of a thylacine on the mainland is a carbon-dated fossil from Murray Cave in Western Australia, which is around 3,100 years old. Its extinction coincided closely with the arrival of wild dogs called dingoes in Australia and a similar predator in New Guinea. Dingoes never reached Tasmania, and most scientists see this as the main reason for the thylacine’s survival there.</p>
                        <p>The dramatic decline of the thylacine in Tasmania, which began in the 1830s and continued for a century, is generally attributed to the relentless efforts of sheep farmers and bounty hunters** with shotguns. While this determined campaign undoubtedly played a large part, it is likely that various other factors also contributed to the decline and eventual extinction of the species. These include competition with wild dogs introduced by European settlers, loss of habitat along with the disappearance of prey species, and a distemper-like disease which may also have affected the thylacine.</p>
                        <p>There was only one successful attempt to breed a thylacine in captivity, at Melbourne Zoo in 1899. This was despite the large numbers that went through some zoos, particularly London Zoo and Tasmania’s Hobart Zoo. The famous naturalist John Gould foresaw the thylacine’s demise when he published his <em>Mammals of Australia</em> between 1848 and 1863, writing, ‘The numbers of this singular animal will speedily diminish, extermination will have its full sway, and it will then, like the wolf of England and Scotland, be recorded as an animal of the past.’</p>
                        <p>However, there seems to have been little public pressure to preserve the thylacine, nor was much concern expressed by scientists at the decline of this species in the decades that followed. A notable exception was T.T. Flynn, Professor of Biology at the University of Tasmania. In 1914, he was sufficiently concerned about the scarcity of the thylacine to suggest that some should be captured and placed on a small island. But it was not until 1929, with the species on the very edge of extinction, that Tasmania’s Animals and Birds Protection Board passed a motion protecting thylacines only for the month of December, which was thought to be their prime breeding season. The last known wild thylacine to be killed was shot by a farmer in the north-east of Tasmania in 1930, leaving just captive specimens. Official protection of the species by the Tasmanian government was introduced in July 1936, 59 days before the last known individual died in Hobart Zoo on 7th September, 1936.</p>
                        <p>There have been numerous expeditions and searches for the thylacine over the years, none of which has produced definitive evidence that thylacines still exist. The species was declared extinct by the Tasmanian government in 1986.</p>
                        <p><small>* marsupial: a mammal, such as a kangaroo, whose young are born incompletely developed and are typically carried and suckled in a pouch on the mother’s belly<br>**bounty hunters: people who are paid a reward for killing a wild animal</small></p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 1-5</h4>
                        <p class="mb-4">Complete the notes below. Choose <strong>ONE WORD ONLY</strong> from the passage for each answer.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <h5 class="font-bold">The thylacine</h5>
                            <p><strong>Appearance and behaviour</strong></p>
                            <ul class="list-disc list-inside">
                               <li>looked rather like a dog</li>
                               <li>had a series of stripes along its body and tail</li>
                               <li>ate an entirely <strong>1</strong> <input type="text" id="q1" class="w-24"> diet</li>
                               <li>probably depended mainly on <strong>2</strong> <input type="text" id="q2" class="w-24"> when hunting</li>
                               <li>young spent first months of life inside its mother’s <strong>3</strong> <input type="text" id="q3" class="w-24"></li>
                            </ul>
                            <p><strong>Decline and extinction</strong></p>
                            <ul class="list-disc list-inside">
                               <li>last evidence in mainland Australia is a 3,100-year-old <strong>4</strong> <input type="text" id="q4" class="w-24"></li>
                               <li>probably went extinct in mainland Australia due to animals known as dingoes</li>
                               <li>reduction in <strong>5</strong> <input type="text" id="q5" class="w-24"> and available sources of food were partly responsible for decline in Tasmania</li>
                            </ul>
                        </div>
                        <h4 class="font-bold mb-2">Questions 6-13</h4>
                        <p class="mb-4">Do the following statements agree with the information given in Reading Passage 1? Write <strong>TRUE</strong>, <strong>FALSE</strong>, or <strong>NOT GIVEN</strong>.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                           <p><strong>6</strong> Significant numbers of thylacines were killed by humans from the 1830s onwards. <input type="text" id="q6" class="w-32"></p>
                           <p><strong>7</strong> Several thylacines were born in zoos during the late 1800s. <input type="text" id="q7" class="w-32"></p>
                           <p><strong>8</strong> John Gould’s prediction about the thylacine surprised some biologists. <input type="text" id="q8" class="w-32"></p>
                           <p><strong>9</strong> In the early 1900s, many scientists became worried about the possible extinction of the thylacine. <input type="text" id="q9" class="w-32"></p>
                           <p><strong>10</strong> T.T. Flynn’s proposal to rehome captive thylacines on an island proved to be impractical. <input type="text" id="q10" class="w-32"></p>
                           <p><strong>11</strong> There were still reasonable numbers of thylacines in existence when a piece of legislation protecting the species during their breeding season was passed. <input type="text" id="q11" class="w-32"></p>
                           <p><strong>12</strong> From 1930 to 1936, the only known living thylacines were all in captivity. <input type="text" id="q12" class="w-32"></p>
                           <p><strong>13</strong> Attempts to find living thylacines are now rarely made. <input type="text" id="q13" class="w-32"></p>
                        </div>
                    `
                },
                {
                    title: "Passage 2",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">Palm oil</h3>
                        <p><strong>A</strong> Palm oil is an edible oil derived from the fruit of the African oil palm tree, and is currently the most consumed vegetable oil in the world. It’s almost certainly in the soap we wash with in the morning, the sandwich we have for lunch, and the biscuits we snack on during the day. Why is palm oil so attractive for manufacturers? Primarily because its unique properties – such as remaining solid at room temperature – make it an ideal ingredient for long-term preservation, allowing many packaged foods on supermarket shelves to have ‘best before’ dates of months, even years, into the future.</p>
                        <p><strong>B</strong> Many farmers have seized the opportunity to maximise the planting of oil palm trees. Between 1990 and 2012, the global land area devoted to growing oil palm trees grew from 6 to 17 million hectares, now accounting for around ten percent of total cropland in the entire world. From a mere two million tonnes of palm oil being produced annually globally 50 years ago, there are now around 60 million tonnes produced every single year, a figure looking likely to double or even triple by the middle of the century.</p>
                        <p><strong>C</strong> However, there are multiple reasons why conservationists cite the rapid spread of oil palm plantations as a major concern. There are countless news stories of deforestation, habitat destruction and dwindling species populations, all as a direct result of land clearing to establish oil palm tree monoculture on an industrial scale, particularly in Malaysia and Indonesia. Endangered species – most famously the Sumatran orangutan, but also rhinos, elephants, tigers, and numerous other fauna – have suffered from the unstoppable spread of oil palm plantations.</p>
                        <p><strong>D</strong> ‘Palm oil is surely one of the greatest threats to global biodiversity,’ declares Dr Farnon Ellwood of the University of the West of England, Bristol. ‘Palm oil is replacing rainforest, and rainforest is where all the species are. That’s a problem.’ This has led to some radical questions among environmentalists, such as whether consumers should try to boycott palm oil entirely. Meanwhile Bhavani Shankar, Professor at London’s School of Oriental and African Studies, argues, ‘It’s easy to say that palm oil is the enemy and we should be against it. It makes for a more dramatic story, and it’s very intuitive. But given the complexity of the argument, I think a much more nuanced story is closer to the truth.’</p>
                        <p><strong>E</strong> One response to the boycott movement has been the argument for the vital role palm oil plays in lifting many millions of people in the developing world out of poverty. Is it desirable to have palm oil boycotted, replaced, eliminated from the global supply chain, given how many low-income people in developing countries depend on it for their livelihoods? How best to strike a utilitarian balance between these competing factors has become a serious bone of contention.</p>
                        <p><strong>F</strong> Even the deforestation argument isn’t as straightforward as it seems. Oil palm plantations produce at least four and potentially up to ten times more oil per hectare than soybean, rapeseed, sunflower or other competing oils. That immensely high yield – which is predominantly what makes it so profitable – is potentially also an ecological benefit. If ten times more palm oil can be produced from a patch of land than any competing oil, then ten times more land would need to be cleared in order to produce the same volume of oil from that competitor. As for the question of carbon emissions, the issue really depends on what oil palm trees are replacing. Crops vary in the degree to which they sequester carbon – in other words, the amount of carbon they capture from the atmosphere and store within the plant. The more carbon a plant sequesters, the more it reduces the effect of climate change. As Shankar explains: ‘[Palm oil production] actually sequesters more carbon in some ways than other alternatives. [...] Of course, if you’re cutting down virgin forest it’s terrible – that’s what’s happening in Indonesia and Malaysia, it’s been allowed to get out of hand. But if it’s replacing rice, for example, it might actually sequester more carbon.’</p>
                        <p><strong>G</strong> The industry is now regulated by a group called the Roundtable on Sustainable Palm Oil (RSPO), consisting of palm growers, retailers, product manufacturers, and other interested parties. Over the past decade or so, an agreement has gradually been reached regarding standards that producers of palm oil have to meet in order for their product to be regarded as officially ‘sustainable’. The RSPO insists upon no virgin forest clearing, transparency and regular assessment of carbon stocks, among other criteria. Only once these requirements are fully satisfied is the oil allowed to be sold as certified sustainable palm oil (CSPO). Recent figures show that the RSPO now certifies around 12 million tonnes of palm oil annually, equivalent to roughly 21 percent of the world’s total palm oil production.</p>
                        <p><strong>H</strong> There is even hope that oil palm plantations might not need to be such sterile monocultures, or ‘green deserts’, as Ellwood describes them. New research at Ellwood’s lab hint at one plant which might make all the difference. The bird’s nest fern (<em>Asplenium nidus</em>) grows on trees in an epiphytic fashion (meaning it’s dependent on the tree only for support, not for nutrients), and is native to many tropical regions, where as a keystone species it performs a vital ecological role. Ellwood believes that reintroducing the bird’s nest fern into oil palm plantations could potentially allow these areas to recover their biodiversity, providing a home for all manner of species, from fungi and bacteria, to invertebrates such as insects, amphibians, reptiles and even mammals.</p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 14-20</h4>
                        <p class="mb-4">Reading Passage 2 has eight paragraphs, A-H. Which paragraph contains the following information?</p>
                         <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <p><strong>14</strong> examples of a range of potential environmental advantages of oil palm tree cultivation <input type="text" id="q14" class="w-16"></p>
                            <p><strong>15</strong> description of an organisation which controls the environmental impact of palm oil production <input type="text" id="q15" class="w-16"></p>
                            <p><strong>16</strong> examples of the widespread global use of palm oil <input type="text" id="q16" class="w-16"></p>
                            <p><strong>17</strong> reference to a particular species which could benefit the ecosystem of oil palm plantations <input type="text" id="q17" class="w-16"></p>
                            <p><strong>18</strong> figures illustrating the rapid expansion of the palm oil industry <input type="text" id="q18" class="w-16"></p>
                            <p><strong>19</strong> an economic justification for not opposing the palm oil industry <input type="text" id="q19" class="w-16"></p>
                            <p><strong>20</strong> examples of creatures badly affected by the establishment of oil palm plantations <input type="text" id="q20" class="w-16"></p>
                        </div>
                        <h4 class="font-bold mb-2">Questions 21 and 22</h4>
                        <p class="mb-4">Choose <strong>TWO</strong> letters, A-E.</p>
                        <p class="mb-4">Which <strong>TWO</strong> statements are made about the Roundtable on Sustainable Palm Oil (RSPO)?</p>
                        <div class="space-y-2 p-4 border rounded-lg bg-white mb-6">
                            <label class="block"><input type="checkbox" name="q21_22" value="A"> A Its membership has grown steadily over the course of the last decade.</label>
                            <label class="block"><input type="checkbox" name="q21_22" value="B"> B It demands that certified producers be open and honest about their practices.</label>
                            <label class="block"><input type="checkbox" name="q21_22" value="C"> C It took several years to establish its set of criteria for sustainable palm oil certification.</label>
                            <label class="block"><input type="checkbox" name="q21_22" value="D"> D Its regulations regarding sustainability are stricter than those governing other industries.</label>
                            <label class="block"><input type="checkbox" name="q21_22" value="E"> E It was formed at the request of environmentalists concerned about the loss of virgin forests.</label>
                        </div>

                         <h4 class="font-bold mb-2">Questions 23-26</h4>
                        <p class="mb-4">Complete the sentences below. Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                           <p><strong>23</strong> One advantage of palm oil for manufacturers is that it stays ........................... even when not refrigerated. <input type="text" id="q23"></p>
                           <p><strong>24</strong> The ........................... is the best known of the animals suffering habitat loss as a result of the spread of oil palm plantations. <input type="text" id="q24"></p>
                           <p><strong>25</strong> As one of its criteria for the certification of sustainable palm oil, the RSPO insists that growers check ........................... on a routine basis. <input type="text" id="q25"></p>
                           <p><strong>26</strong> Ellwood and his researchers are looking into whether the bird’s nest fern could restore ........................... in areas where oil palm trees are grown. <input type="text" id="q26"></p>
                        </div>
                    `
                },
                {
                    title: "Passage 3",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">Building the Skyline: The Birth and Growth of Manhattan’s Skyscrapers</h3>
                        <p><em>Katharine L. Shester reviews a book by Jason Barr about the development of New York City</em></p>
                        <p>In <em>Building the Skyline</em>, Jason Barr takes the reader through a detailed history of New York City. The book combines geology, history, economics, and a lot of data to explain why business clusters developed where they did and how the early decisions of workers and firms shaped the skyline we see today. <em>Building the Skyline</em> is organized into two distinct parts. The first is primarily historical and addresses New York’s settlement and growth from 1609 to 1900; the second deals primarily with the 20th century and is a compilation of chapters commenting on different aspects of New York’s urban development. The tone and organization of the book changes somewhat between the first and second parts, as the latter chapters incorporate aspects of Barr’s related research papers.</p>
                        <p>Barr begins chapter one by taking the reader on a ‘helicopter time-machine’ ride – giving a fascinating account of how the New York landscape in 1609 might have looked from the sky. He then moves on to a subterranean walking tour of the city, indicating the location of rock and water below the subsoil, before taking the reader back to the surface. His love of the city comes through as he describes various fun facts about the location of the New York residence of early 19th-century vice-president Aaron Burr as well as a number of legends about the city.</p>
                        <p>Chapters two and three take the reader up to the Civil War (1861-1865), with chapter two focusing on the early development of land and the implementation of a grid system in 1811. Chapter three focuses on land use before the Civil War. Both chapters are informative and well researched and set the stage for the economic analysis that comes later in the book. I would have liked Barr to expand upon his claim that existing tenements* prevented skyscrapers in certain neighborhoods because ‘likely no skyscraper developer was interested in performing the necessary “slum clearance”’. Later in the book, Barr makes the claim that the depth of bedrock** was not a limiting factor for developers, as foundation costs were a small fraction of the cost of development. At first glance, it is not obvious why slum clearance would be limiting, while more expensive foundations would not.</p>
                        <p>Chapter four focuses on immigration and the location of neighborhoods and tenements in the late 19th century. Barr identifies four primary immigrant enclaves and analyses their locations in terms of the amenities available in the area. Most of these enclaves were located on the least valuable land, between the industries located on the waterfront and the wealthy neighborhoods bordering Central Park.</p>
                        <p>Part two of the book begins with a discussion of the economics of skyscraper height. In chapter five, Barr distinguishes between engineering height, economic height, and developer height – where engineering height is the tallest building that can be safely made at a given time, economic height is the height that is most efficient from society’s point of view, and developer height is the actual height chosen by the developer, who is attempting to maximize return on investment.</p>
                        <p>Chapter five also has an interesting discussion of the technological advances that led to the construction of skyscrapers. For example, the introduction of iron and steel skeletal frames made thick, load-bearing walls unnecessary, expanding the usable square footage of buildings and increasing the use of windows and availability of natural light. Chapter six then presents data on building height throughout the 20th century and uses regression analysis to ‘predict’ building construction. While less technical than the research paper on which the chapter is based, it is probably more technical than would be preferred by a general audience.</p>
                        <p>Chapter seven tackles the ‘bedrock myth’, the assumption that the absence of bedrock close to the surface between Downtown and Midtown New York is the reason for skyscrapers not being built between the two urban centers. Rather, Barr argues that while deeper bedrock does increase foundation costs, these costs were neither prohibitively high nor were they large compared to the overall cost of building a skyscraper. What I enjoyed the most about this chapter was Barr’s discussion of how foundations are actually built. He describes the use of caissons, which enable workers to dig down for considerable distances, often below the water table, until they reach bedrock. Barr’s thorough technological history discusses not only how caissons work, but also the dangers involved. While this chapter references empirical research papers, it is a relatively easy read.</p>
                        <p>Chapters eight and nine focus on the birth of Midtown and the building boom of the 1920s. Chapter eight contains lengthy discussions of urban economic theory that may serve as a distraction to readers primarily interested in New York. However, they would be well-suited for undergraduates learning about the economics of cities. In the next chapter, Barr considers two of the primary explanations for the building boom of the 1920s – the first being exuberance, and the second being financing. He uses data to assess the viability of these two explanations and finds that supply and demand factors explain much of the development of the 1920s; though it enable the boom, cheap credit was not, he argues, the primary cause.</p>
                        <p>In the final chapter (chapter 10), Barr discusses another of his empirical papers that estimates Manhattan land values from the mid-19th century to the present day. The data work that went into these estimations is particularly impressive. Toward the end of the chapter, Barr assesses ‘whether skyscrapers are a cause or an effect of high land values’. He finds that changes in land values predict future building height, but the reverse is not true. The book ends with an epilogue, in which Barr discusses the impact of climate change on the city and makes policy suggestions for New York going forward.</p>
                        <p><small>* a tenement: a multi-occupancy building of any sort, but particularly a run-down apartment building or slum building<br>** bedrock: the solid, hard rock in the ground that lies under a loose layer of soil</small></p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 27-31</h4>
                        <p class="mb-4">Choose the correct letter, <strong>A, B, C or D</strong>.</p>
                        <div class="space-y-4 p-4 border rounded-lg bg-white mb-6">
                            <div class="q-item">
                                <p><strong>27</strong> What point does Shester make about Barr’s book in the first paragraph?</p>
                                <label class="block"><input type="radio" name="q27" value="A"> A It gives a highly original explanation for urban development.</label>
                                <label class="block"><input type="radio" name="q27" value="B"> B Elements of Barr’s research papers are incorporated throughout the book.</label>
                                <label class="block"><input type="radio" name="q27" value="C"> C Other books that are available on the subject have taken a different approach.</label>
                                <label class="block"><input type="radio" name="q27" value="D"> D It covers a range of factors that affected the development of New York.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>28</strong> How does Shester respond to the information in the book about tenements?</p>
                                <label class="block"><input type="radio" name="q28" value="A"> A She describes the reasons for Barr’s interest.</label>
                                <label class="block"><input type="radio" name="q28" value="B"> B She indicates a potential problem with Barr’s analysis.</label>
                                <label class="block"><input type="radio" name="q28" value="C"> C She compares Barr’s conclusion with that of other writers.</label>
                                <label class="block"><input type="radio" name="q28" value="D"> D She provides details about the sources Barr used for his research.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>29</strong> What does Shester say about chapter six of the book?</p>
                                <label class="block"><input type="radio" name="q29" value="A"> A It contains conflicting data.</label>
                                <label class="block"><input type="radio" name="q29" value="B"> B It focuses too much on possible trends.</label>
                                <label class="block"><input type="radio" name="q29" value="C"> C It is too specialised for most readers.</label>
                                <label class="block"><input type="radio" name="q29" value="D"> D It draws on research that is out of date.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>30</strong> What does Shester suggest about the chapters focusing on the 1920s building boom?</p>
                                <label class="block"><input type="radio" name="q30" value="A"> A The information should have been organised differently.</label>
                                <label class="block"><input type="radio" name="q30" value="B"> B More facts are needed about the way construction was financed.</label>
                                <label class="block"><input type="radio" name="q30" value="C"> C The explanation that is given for the building boom is unlikely.</label>
                                <label class="block"><input type="radio" name="q30" value="D"> D Some parts will have limited appeal to certain people.</label>
                            </div>
                             <div class="q-item">
                                <p><strong>31</strong> What impresses Shester the most about the chapter on land values?</p>
                                <label class="block"><input type="radio" name="q31" value="A"> A the broad time period that is covered</label>
                                <label class="block"><input type="radio" name="q31" value="B"> B the interesting questions that Barr asks</label>
                                <label class="block"><input type="radio" name="q31" value="C"> C the nature of the research into the topic</label>
                                <label class="block"><input type="radio" name="q31" value="D"> D the recommendations Barr makes for the future</label>
                            </div>
                        </div>
                        <h4 class="font-bold mb-2">Questions 32-35</h4>
                        <p class="mb-4">Do the following statements agree with the claims of the writer in Reading Passage 3? Write <strong>YES</strong>, <strong>NO</strong>, or <strong>NOT GIVEN</strong>.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                           <p><strong>32</strong> The description in the first chapter of how New York probably looked from the air in the early 1600s lacks interest. <input type="text" id="q32" class="w-32"></p>
                           <p><strong>33</strong> Chapters two and three prepare the reader well for material yet to come. <input type="text" id="q33" class="w-32"></p>
                           <p><strong>34</strong> The biggest problem for many nineteenth-century New York immigrant neighbourhoods was a lack of amenities. <input type="text" id="q34" class="w-32"></p>
                           <p><strong>35</strong> In the nineteenth century, New York’s immigrant neighbourhoods tended to concentrate around the harbour. <input type="text" id="q35" class="w-32"></p>
                        </div>
                        <h4 class="font-bold mb-2">Questions 36-40</h4>
                        <p class="mb-4">Complete the summary using the list of phrases, A-J, below.</p>
                        <div class="p-4 border rounded-lg bg-gray-50 mb-4">
                            <p><strong>A</strong> development plans <strong>B</strong> deep excavations <strong>C</strong> great distance</p>
                            <p><strong>D</strong> excessive expense <strong>E</strong> impossible tasks <strong>F</strong> associated risks</p>
                            <p><strong>G</strong> water level <strong>H</strong> specific areas <strong>I</strong> total expenditure</p>
                            <p><strong>J</strong> construction guidelines</p>
                        </div>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <p><strong>The bedrock myth</strong></p>
                            <p>In chapter seven, Barr indicates how the lack of bedrock close to the surface does not explain why skyscrapers are absent from <strong>36</strong> ......................... He points out that although the cost of foundations increases when bedrock is deep below the surface, this cannot be regarded as <strong>37</strong> ........................, especially when compared to <strong>38</strong> .........................</p>
                            <p>A particularly enjoyable part of the chapter was Barr’s account of how foundations are built. He describes not only how <strong>39</strong> ........................ are made possible by the use of caissons, but he also discusses their <strong>40</strong> ......................... The chapter is well researched but relatively easy to understand.</p>
                            <p>
                                36 <input type="text" id="q36" class="w-16">
                                37 <input type="text" id="q37" class="w-16">
                                38 <input type="text" id="q38" class="w-16">
                                39 <input type="text" id="q39" class="w-16">
                                40 <input type="text" id="q40" class="w-16">
                            </p>
                        </div>
                    `
                }
            ]
        }
    };

    const answers = {
        // Reading Passage 1
        q1: "carnivorous", q2: "scent", q3: "pouch", q4: "fossil", q5: "habitat",
        q6: "true", q7: "false", q8: "not given", q9: "false", q10: "not given",
        q11: "false", q12: "true", q13: "not given",
        // Reading Passage 2
        q14: "F", q15: "G", q16: "A", q17: "H", q18: "B", q19: "E", q20: "C",
        "q21_22": "B/C", 
        q23: "solid", q24: "orangutan", q25: "carbon stocks", q26: "biodiversity",
        // Reading Passage 3
        q27: "D", q28: "B", q29: "C", q30: "D", q31: "C",
        q32: "no", q33: "yes", q34: "not given", q35: "no",
        q36: "H", q37: "D", q38: "I", q39: "B", q40: "F"
    };


    // --- APPLICATION LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        const app = {
            // State
            userAnswers: {},
            currentTab: 'reading',
            currentSection: 0,
            answersChecked: {},

            // Elements
            leftPane: document.getElementById('left-pane'),
            rightPane: document.getElementById('right-pane'),
            questionsSection: document.getElementById('questions-section'),
            splitter: document.getElementById('splitter'),
            sectionTabsContainer: document.getElementById('section-tabs'),
            highlightTooltip: document.getElementById('highlight-tooltip'),

            init() {
                this.setupEventListeners();
                this.loadContent();
                this.initSplitter();
                this.initHighlighter();
            },

            setupEventListeners() {
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                });
                // Use event delegation for dynamically added elements
                document.body.addEventListener('input', (e) => this.saveAnswer(e));
                document.body.addEventListener('click', (e) => {
                    if (e.target.classList.contains('check-exercise-btn')) {
                        this.checkExerciseAnswers(e.target.dataset.exercise, e.target.dataset.range);
                    }
                });
            },
            
            saveAnswer(e) {
                const target = e.target;
                if (target.id || target.name) {
                    const id = target.id || target.name;
                    if (target.type === 'radio') {
                        if (target.checked) this.userAnswers[id] = target.value;
                    } else if (target.type === 'checkbox') {
                        const checked = Array.from(document.querySelectorAll(`input[name="${id}"]:checked`)).map(cb => cb.value).sort().join('/');
                        this.userAnswers[id] = checked;
                    } else {
                         this.userAnswers[id] = target.value;
                    }
                }
            },

            restoreAnswers() {
                for (const qId in this.userAnswers) {
                    const value = this.userAnswers[qId];
                    const textInput = document.getElementById(qId);
                    if (textInput) {
                        textInput.value = value;
                    } else {
                        const multiInputs = document.querySelectorAll(`input[name="${qId}"]`);
                        if (multiInputs.length > 0) {
                            if (multiInputs[0].type === 'checkbox') {
                                const values = value.split('/');
                                multiInputs.forEach(input => {
                                    input.checked = values.includes(input.value);
                                });
                            } else { // radio
                                multiInputs.forEach(radio => {
                                    if (radio.value === value) radio.checked = true;
                                });
                            }
                        }
                    }
                }
            },

            checkExerciseAnswers(exerciseKey, range) {
                if (this.answersChecked[exerciseKey]) {
                    this.answersChecked[exerciseKey] = false;
                    this.loadContent();
                    return;
                }
                this.answersChecked[exerciseKey] = true;
                this.showExerciseAnswers(exerciseKey, range);
            },

            switchTab(tabName) {
                this.currentTab = tabName;
                this.currentSection = 0;
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.tab === tabName);
                });
                this.loadContent();
            },
            
            switchSection(sectionIndex) {
                 this.currentSection = sectionIndex;
                 this.loadContent();
            },

            loadContent() {
                const data = testData[this.currentTab];
                if (!data) return;
                const sectionData = data.sections[this.currentSection];

                this.leftPane.innerHTML = `<div class="reading-passage">${sectionData.passage}</div>`;
                this.questionsSection.innerHTML = sectionData.questions;

                this.sectionTabsContainer.innerHTML = data.sections.map((sec, index) =>
                    `<button class="section-btn ${index === this.currentSection ? 'active' : ''}" data-section-index="${index}">${sec.title}</button>`
                ).join('');
                
                this.sectionTabsContainer.querySelectorAll('.section-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchSection(parseInt(e.target.dataset.sectionIndex, 10)));
                });
                
                this.restoreAnswers();
                this.addReadingExerciseButtons();

                const sectionKey = `${this.currentTab}_${this.currentSection}`;
                const exercises = this.getReadingExerciseTypes();
                exercises.forEach(ex => {
                    const exerciseKey = `${sectionKey}_${ex.type}`;
                    if(this.answersChecked[exerciseKey]) {
                        this.showExerciseAnswers(exerciseKey, `${ex.startQ}-${ex.endQ}`);
                    }
                });
            },
            
            getReadingExerciseTypes() {
                const exerciseTypes = {
                    0: [ 
                        { type: 'notes_completion', startQ: 1, endQ: 5, title: 'Notes Completion (Q1-5)' },
                        { type: 'true_false', startQ: 6, endQ: 13, title: 'True/False/Not Given (Q6-13)' }
                    ],
                    1: [ 
                        { type: 'paragraph_matching', startQ: 14, endQ: 20, title: 'Paragraph Matching (Q14-20)' },
                        { type: 'multiple_selection', startQ: 21, endQ: 22, title: 'Multiple Selection (Q21-22)' },
                        { type: 'sentence_completion', startQ: 23, endQ: 26, title: 'Sentence Completion (Q23-26)' }
                    ],
                    2: [ 
                        { type: 'multiple_choice', startQ: 27, endQ: 31, title: 'Multiple Choice (Q27-31)' },
                        { type: 'yes_no', startQ: 32, endQ: 35, title: 'Yes/No/Not Given (Q32-35)' },
                        { type: 'summary_completion', startQ: 36, endQ: 40, title: 'Summary Completion (Q36-40)' }
                    ]
                };
                return exerciseTypes[this.currentSection] || [];
            },

            addReadingExerciseButtons() {
                const sectionKey = `${this.currentTab}_${this.currentSection}`;
                const exercises = this.getReadingExerciseTypes();

                exercises.forEach(exercise => {
                    const exerciseKey = `${sectionKey}_${exercise.type}`;
                    const isChecked = this.answersChecked[exerciseKey];
                    const buttonText = isChecked ? 'Reset Answers' : 'Check Answers';
                    const buttonColor = isChecked ? 'bg-gray-600 hover:bg-gray-700' : 'bg-blue-600 hover:bg-blue-700';

                    const buttonContainer = document.createElement('div');
                    buttonContainer.className = 'mt-6 p-4 bg-gray-100 rounded-lg text-center';
                    buttonContainer.innerHTML = `
                        <p class="font-semibold mb-2">${exercise.title}</p>
                        <button class="check-exercise-btn ${buttonColor} text-white font-bold py-2 px-6 rounded-md transition-colors" data-exercise="${exerciseKey}" data-range="${exercise.startQ}-${exercise.endQ}">
                            ${buttonText}
                        </button>
                    `;

                    const firstQuestionInput = document.getElementById(`q${exercise.startQ}`) || document.querySelector(`input[name="q${exercise.startQ}"]`)  || document.querySelector(`input[name="q${exercise.startQ}_${exercise.endQ}"]`);
                    if (firstQuestionInput) {
                        const questionBlock = firstQuestionInput.closest('.space-y-3, .space-y-4, .space-y-2, .mb-6');
                        if (questionBlock) {
                            questionBlock.appendChild(buttonContainer);
                        } else {
                            this.questionsSection.appendChild(buttonContainer);
                        }
                    } else {
                         this.questionsSection.appendChild(buttonContainer);
                    }
                });
            },
            
            showExerciseAnswers(exerciseKey, range) {
                const [startQ, endQ] = range.split('-').map(Number);

                for (let i = startQ; i <= endQ; i++) {
                    let qId = `q${i}`;
                    if (i >= 21 && i <= 22) { // Handle checkbox group for Q21-22
                        qId = `q${21}_${22}`;
                        const userAnswer = this.userAnswers[qId] || '';
                        const correctAnswer = answers[qId].toLowerCase();
                        const isCorrect = userAnswer === correctAnswer;

                        document.querySelectorAll(`input[name="${qId}"]`).forEach(input => {
                            const label = input.closest('label');
                            if (input.checked) {
                                if (correctAnswer.includes(input.value.toLowerCase())) {
                                    label.classList.add('correct-answer');
                                } else {
                                    label.classList.add('incorrect-answer');
                                }
                            } else if (correctAnswer.includes(input.value.toLowerCase())) {
                                label.style.border = '2px solid #fbbf24';
                            }
                        });
                        continue;
                    }


                    const inputs = document.querySelectorAll(`#${qId}, input[name="${qId}"]`);
                    if (inputs.length === 0) continue;

                    const userAnswer = (this.userAnswers[qId] || "").toLowerCase().trim();
                    const correctAnswer = (answers[qId] || "").toLowerCase();
                    const isCorrect = correctAnswer.split('/').some(ans => ans.trim() === userAnswer);
                    
                    const inputElement = document.getElementById(qId) || document.querySelector(`input[name="${qId}"]:checked`);

                    if (inputElement) {
                         const elementToStyle = inputElement.type === 'radio' ? inputElement.closest('label') : inputElement;
                         if (isCorrect) {
                            elementToStyle.classList.add('correct-answer');
                            if(inputElement.type === 'text') inputElement.style.backgroundColor = '#dcfce7';
                        } else {
                            elementToStyle.classList.add('incorrect-answer');
                             if(inputElement.type === 'text') {
                                 inputElement.style.backgroundColor = '#fef2f2';
                                 inputElement.placeholder = `Correct: ${answers[qId]}`;
                             }
                        }
                    } else if (inputs[0] && inputs[0].type === 'text') {
                        inputs[0].classList.add('incorrect-answer');
                        inputs[0].style.backgroundColor = '#fef2f2';
                        inputs[0].placeholder = `Correct: ${answers[qId]}`;
                    }
                    
                     if (inputs[0] && inputs[0].type === 'radio' && !isCorrect) {
                         const correctRadio = document.querySelector(`input[name="${qId}"][value="${answers[qId]}"]`);
                         if(correctRadio) correctRadio.closest('label').classList.add('correct-answer');
                    }
                }

                const btn = document.querySelector(`button[data-exercise="${exerciseKey}"]`);
                if (btn) {
                    btn.textContent = 'Reset Answers';
                    btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    btn.classList.add('bg-gray-600', 'hover:bg-gray-700');
                }
            },


            initSplitter() {
                let isDragging = false;
                const contentPanes = document.getElementById('content-panes');

                this.splitter.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    isDragging = true;
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    e.preventDefault();
                    const containerRect = contentPanes.getBoundingClientRect();
                    const newLeftWidth = e.clientX - containerRect.left;
                    if (newLeftWidth > 100 && newLeftWidth < containerRect.width - 100) {
                        const newLeftPercent = (newLeftWidth / containerRect.width) * 100;
                        contentPanes.style.gridTemplateColumns = `${newLeftPercent}% 5px 1fr`;
                    }
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                });
            },

            initHighlighter() {
                document.body.addEventListener('mouseup', (e) => {
                    const selection = window.getSelection();
                    const selectedText = selection.toString().trim();

                    if (selectedText.length > 0) {
                        const range = selection.getRangeAt(0);
                        if (!this.leftPane.contains(range.commonAncestorContainer) && !this.rightPane.contains(range.commonAncestorContainer)) {
                           this.highlightTooltip.style.display = 'none';
                           return;
                        }

                        const rect = range.getBoundingClientRect();
                        this.highlightTooltip.style.left = `${e.pageX}px`;
                        this.highlightTooltip.style.top = `${e.pageY - 30}px`;
                        this.highlightTooltip.style.display = 'block';

                        this.highlightTooltip.onclick = () => {
                            const mark = document.createElement('mark');
                            try {
                                range.surroundContents(mark);
                            } catch (ex) { console.warn(ex); }
                            selection.removeAllRanges();
                            this.highlightTooltip.style.display = 'none';
                        };
                    } else {
                        this.highlightTooltip.style.display = 'none';
                    }
                });

                document.body.addEventListener('mousedown', (e) => {
                   if (e.target !== this.highlightTooltip) {
                        this.highlightTooltip.style.display = 'none';
                   }
                });
            }
        };

        app.init();
    });
</script>

</body>
</html>
