<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Academic Test Simulator - Cambridge 13 Test 3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none;
        }
        .ielts-container {
            display: grid;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
        }
        .content-panes {
            display: grid;
            grid-template-columns: 1fr 5px 1fr;
            overflow: hidden;
        }
        .questions-section {
            width: 100%;
        }
        .script-section {
            width: 100%;
            background-color: #faf5ff;
            border-radius: 0.5rem;
            padding: 1rem;
            border: 2px solid #e9d5ff;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        .script-section.hidden {
            display: none !important;
        }
        .pane {
            overflow-y: auto;
            padding: 1.5rem;
        }
        .splitter {
            background-color: #d1d5db;
            cursor: col-resize;
            z-index: 10;
        }
        .tab-btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background-color: #f9fafb;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab-btn:hover {
            background-color: #f3f4f6;
        }
        .tab-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .section-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background-color: #f9fafb;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 4px;
        }
        .section-btn:hover {
            background-color: #e5e7eb;
        }
        .section-btn.active {
            background-color: #1d4ed8;
            color: white;
            border-color: #1d4ed8;
        }
        .play-audio-btn {
            display: inline-flex;
            align-items: center;
            padding: 10px 20px;
            background-color: #2563eb;
            color: white;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .play-audio-btn:hover {
            background-color: #1d4ed8;
        }
        .play-audio-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .highlight-tooltip {
            position: absolute;
            background-color: #1f2937;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 100;
            cursor: pointer;
            display: none;
        }
        mark {
            background-color: #fef08a;
            border-radius: 2px;
        }
        input[type="text"] {
            border: 1px solid #9ca3af;
            border-radius: 4px;
            padding: 4px 8px;
            width: 150px;
        }
        input[type="text"]:focus {
            outline: 2px solid #3b82f6;
            border-color: #3b82f6;
        }
        .audio-seeker {
            -webkit-appearance: none;
            appearance: none;
            background: #e5e7eb;
            outline: none;
            border-radius: 0.5rem;
        }
        .audio-seeker::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }
        .audio-seeker::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }
        .question-highlight {
            background-color: #fef08a;
            color: #92400e;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            border: 2px solid #f59e0b;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: inline-block;
            margin: 0 2px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .question-highlight:hover {
            background-color: #fde047;
            border-color: #d97706;
            transform: scale(1.05);
        }
        .reading-passage {
            line-height: 1.8;
            font-size: 16px;
            color: #374151;
            text-align: justify;
            margin-bottom: 2rem;
        }
        .reading-passage p {
            margin-bottom: 1.5rem;
            text-indent: 1.5rem;
        }
        .reading-passage h3, .reading-passage h4 {
            color: #1f2937;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        .explanation-box {
            animation: fadeIn 0.3s ease-in-out;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .explanation-box:hover {
            background-color: #dbeafe !important;
            transform: scale(1.02);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .correct-answer {
            box-shadow: 0 0 0 2px #16a34a;
        }
        .incorrect-answer {
            box-shadow: 0 0 0 2px #dc2626;
        }
        .passage-answer-highlight {
            background-color: #fef08a;
            border-bottom: 3px solid #f59e0b;
            padding: 2px 4px;
            border-radius: 3px;
            position: relative;
            display: inline-block;
            margin: 0 2px;
        }
        .passage-answer-highlight::after {
            content: attr(data-question);
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #1f2937;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            white-space: nowrap;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        .passage-answer-highlight:hover::after {
            opacity: 1;
        }
        mark {
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 2px;
            padding: 1px 2px;
        }
        mark:hover {
            background-color: #fde047 !important;
            transform: scale(1.02);
        }
        .vocab-word {
            cursor: help;
            border-bottom: 1px dotted #3b82f6;
            color: #1e40af;
            transition: all 0.2s ease;
        }
        .vocab-word:hover {
            background-color: #dbeafe;
            border-bottom-color: #1e40af;
        }
        .reading-passage {
            user-select: text;
        }
        .reading-passage.selecting {
            background-color: rgba(59, 130, 246, 0.05);
        }
        .vocab-tooltip {
            position: absolute;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 350px;
            font-size: 14px;
            line-height: 1.5;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: auto;
            user-select: none;
        }
        .vocab-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }
        .vocab-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid #1e40af;
        }
        .vocab-word-text {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
            color: #fbbf24;
        }
        .vocab-pronunciation {
            font-style: italic;
            color: #e5e7eb;
            margin-bottom: 4px;
        }
        .vocab-ipa {
            font-family: 'Times New Roman', serif;
            color: #d1d5db;
            margin-bottom: 8px;
        }
        .vocab-definition {
            margin-bottom: 8px;
        }
        .vocab-synonyms {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 8px;
            margin-top: 8px;
        }
        .vocab-synonyms-title {
            font-weight: bold;
            color: #fbbf24;
            margin-bottom: 4px;
        }
        .vocab-audio-btn {
            background: #fbbf24;
            color: #1e40af;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 8px;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        .vocab-audio-btn:hover {
            background: #f59e0b;
            transform: scale(1.1);
        }
        .vocab-audio-btn:active {
            transform: scale(0.95);
        }
        .vocab-audio-btn.playing {
            background: #10b981;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div id="test-container" class="ielts-container">
    <!-- Header -->
    <header class="bg-white shadow-md p-3 flex justify-between items-center">
        <h1 class="text-xl font-bold text-blue-600">IELTS Academic Test Simulator - Cambridge 13 Test 3</h1>
        <div class="flex items-center space-x-4">
            <div class="text-lg font-semibold text-gray-600">IELTS Academic Test - Cambridge 13 Test 3</div>
                <button id="toggle-script-btn" class="bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors">
                    Show Script
                </button>
        </div>
    </header>

    <!-- Main Content -->
    <main id="content-panes" class="content-panes">
        <!-- Left Pane: Passages / Instructions -->
        <div id="left-pane" class="pane bg-white">
            <!-- Content will be loaded here by JS -->
        </div>

        <!-- Splitter -->
        <div id="splitter" class="splitter"></div>

        <!-- Right Pane: Questions (Reading) or Script (Listening) -->
        <div id="right-pane" class="pane bg-gray-50">
            <!-- Questions Section (for Reading) -->
            <div id="questions-section" class="questions-section">
                <!-- Questions will be loaded here by JS -->
            </div>
            
            <!-- Script Section (for Listening) -->
            <div id="script-section" class="script-section">
                <div class="mb-4">
                    <h3 class="text-lg font-bold text-purple-800 mb-2">Listening Script</h3>
                    <p class="text-sm text-gray-600">Complete dialogue for the current listening section</p>
                </div>
                <div id="script-content" class="text-sm leading-relaxed overflow-y-auto" style="max-height: calc(100vh - 200px);">
                    <div class="text-gray-500">Script will load here when you click "Show Script"</div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer: Navigation -->
    <footer class="bg-white shadow-inner p-3">
        <div class="flex justify-between items-center">
            <!-- Main Skill Tabs -->
            <div>
                <button class="tab-btn active" data-tab="listening">Listening</button>
                <button class="tab-btn" data-tab="reading">Reading</button>
                <button class="tab-btn" data-tab="vocabulary">Vocabulary Quiz</button>
            </div>
            <!-- Section Tabs -->
            <div id="section-tabs">
                <!-- Section buttons will be loaded here by JS -->
            </div>
        </div>
    </footer>
</div>

<!-- Highlight Tooltip -->
<div id="highlight-tooltip" class="highlight-tooltip">Highlight</div>

<!-- Vocabulary Tooltip -->
<div id="vocab-tooltip" class="vocab-tooltip">
    <div class="vocab-word-text">
        <span class="vocab-word-display"></span>
        <button class="vocab-audio-btn" title="Click to hear pronunciation">🔊</button>
    </div>
    <div class="vocab-pronunciation"></div>
    <div class="vocab-ipa"></div>
    <div class="vocab-definition"></div>
    <div class="vocab-synonyms">
        <div class="vocab-synonyms-title">Synonyms:</div>
        <div class="vocab-synonyms-list"></div>
    </div>
</div>


<script>
    // --- DATA ---
    const testData = {
        listening: {
            duration: 1800, // 30 minutes
            sections: [
                {
                    title: "Section 1",
                    instructions: `
                        <h3 class="text-lg font-bold mb-4">Listening Section 1</h3>
                        <p class="mb-4">You will hear a conversation about moving to Banford City.</p>
                        <div class="p-4 bg-blue-100 rounded-lg">
                            <p class="font-semibold mb-2">Audio Control</p>
                            <audio id="audio-sec1" src="https://s4-media1.study4.com/media/ielts_media/sound/08_Cam13-Test3-Section1.mp3" preload="metadata"></audio>
                            <div class="flex items-center space-x-3 mb-3">
                                <button data-audio-id="audio-sec1" class="play-audio-btn bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 inline" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                                    <span class="play-text">Play</span>
                                </button>
                                <span class="time-display text-sm text-gray-600">0:00 / 0:00</span>
                            </div>
                            <div class="w-full">
                                <input type="range" class="audio-seeker w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="0">
                            </div>
                        </div>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2 mt-6">Questions 1-10</h4>
                        <p class="mb-4">Complete the notes below. Write <strong>ONE WORD AND/OR A NUMBER</strong> for each answer.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <h5 class="font-bold text-center text-lg">Moving to Banford City</h5>
                            <p><strong>Example:</strong> Linda recommends living in suburb of: Dalton</p>
                            <p><strong>Accommodation</strong></p>
                            <ul>
                                <li>Average rent: <strong>1</strong> £<input type="text" id="q1" data-q="1"> a month</li>
                            </ul>
                            <p><strong>Transport</strong></p>
                            <ul>
                                <li>Linda travels to work by <strong>2</strong> <input type="text" id="q2" data-q="2"></li>
                                <li>Limited <strong>3</strong> <input type="text" id="q3" data-q="3"> in city centre</li>
                                <li>Trains to London every <strong>4</strong> <input type="text" id="q4" data-q="4"> minutes</li>
                                <li>Poor train service at <strong>5</strong> <input type="text" id="q5" data-q="5"></li>
                            </ul>
                            <p><strong>Advantages of living in Banford</strong></p>
                            <ul>
                                <li>New <strong>6</strong> <input type="text" id="q6" data-q="6"> opened recently</li>
                                <li><strong>7</strong> <input type="text" id="q7" data-q="7"> has excellent reputation</li>
                                <li>Good <strong>8</strong> <input type="text" id="q8" data-q="8"> on Bridge Street</li>
                            </ul>
                            <p><strong>Meet Linda</strong></p>
                            <ul>
                                <li>Meet Linda on <strong>9</strong> <input type="text" id="q9" data-q="9"> after 5.30 pm</li>
                                <li>In the <strong>10</strong> <input type="text" id="q10" data-q="10"> opposite the station</li>
                            </ul>
                        </div>
                    `
                },
                {
                    title: "Section 2",
                    instructions: `
                        <h3 class="text-lg font-bold mb-4">Listening Section 2</h3>
                        <p class="mb-4">You will hear a talk about physical activities and their advantages.</p>
                        <div class="p-4 bg-blue-100 rounded-lg">
                            <p class="font-semibold mb-2">Audio Control</p>
                            <audio id="audio-sec2" src="https://s4-media1.study4.com/media/ielts_media/sound/08_Cam13-Test3-Section2.mp3" preload="metadata"></audio>
                            <div class="flex items-center space-x-3 mb-3">
                                <button data-audio-id="audio-sec2" class="play-audio-btn bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 inline" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                                    <span class="play-text">Play</span>
                                </button>
                                <span class="time-display text-sm text-gray-600">0:00 / 0:00</span>
                            </div>
                            <div class="w-full">
                                <input type="range" class="audio-seeker w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="0">
                            </div>
                        </div>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2 mt-6">Questions 11-16</h4>
                        <p class="mb-4">What advantage does the speaker mention for each of the following physical activities?</p>
                        <p class="mb-4">Choose <strong>SIX answers</strong> from the box and write the correct letter, <strong>A-G</strong>, next to Questions 11-16</p>
                        <div class="p-4 border rounded-lg bg-gray-50 mb-4">
                            <p class="font-bold mb-2">Advantages</p>
                            <p>A not dependent on season</p>
                            <p>B enjoyable</p>
                            <p>C low risk of injury</p>
                            <p>D fitness level unimportant</p>
                            <p>E sociable</p>
                            <p>F fast results</p>
                            <p>G motivating</p>
                        </div>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <div class="q-item">
                                <p><strong>11</strong> using a gym <input type="text" id="q11" data-q="11" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>12</strong> running <input type="text" id="q12" data-q="12" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>13</strong> swimming <input type="text" id="q13" data-q="13" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>14</strong> cycling <input type="text" id="q14" data-q="14" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>15</strong> doing yoga <input type="text" id="q15" data-q="15" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>16</strong> training with a personal trainer <input type="text" id="q16" data-q="16" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                        </div>
                        <h4 class="font-bold mb-2">Questions 17-18</h4>
                        <p class="mb-4">Choose <strong>TWO letters, A-E</strong>.</p>
                        <p class="mb-4">For which TWO reasons does the speaker say people give up going to the gym?</p>
                        <div class="space-y-2 p-4 border rounded-lg bg-white mb-6">
                            <label class="block"><input type="checkbox" name="q17" value="A"> A lack of time</label>
                            <label class="block"><input type="checkbox" name="q17" value="B"> B loss of confidence</label>
                            <label class="block"><input type="checkbox" name="q17" value="C"> C too much effort required</label>
                            <label class="block"><input type="checkbox" name="q17" value="D"> D high costs</label>
                            <label class="block"><input type="checkbox" name="q17" value="E"> E feeling less successful than others</label>
                        </div>
                        <h4 class="font-bold mb-2">Questions 19-20</h4>
                        <p class="mb-4">Choose <strong>TWO letters, A-E</strong>.</p>
                        <p class="mb-4">Which TWO pieces of advice does the speaker give for setting goals?</p>
                        <div class="space-y-2 p-4 border rounded-lg bg-white">
                            <label class="block"><input type="checkbox" name="q19" value="A"> A write goals down</label>
                            <label class="block"><input type="checkbox" name="q19" value="B"> B have achievable aims</label>
                            <label class="block"><input type="checkbox" name="q19" value="C"> C set a time limit</label>
                            <label class="block"><input type="checkbox" name="q19" value="D"> D give yourself rewards</label>
                            <label class="block"><input type="checkbox" name="q19" value="E"> E challenge yourself</label>
                        </div>
                    `
                },
                {
                    title: "Section 3",
                    instructions: `
                        <h3 class="text-lg font-bold mb-4">Listening Section 3</h3>
                        <p class="mb-4">You will hear a conversation between two students discussing a project on using natural dyes to colour fabrics.</p>
                        <div class="p-4 bg-blue-100 rounded-lg">
                            <p class="font-semibold mb-2">Audio Control</p>
                            <audio id="audio-sec3" src="https://s4-media1.study4.com/media/ielts_media/sound/08_Cam13-Test3-Section3.mp3" preload="metadata"></audio>
                            <div class="flex items-center space-x-3 mb-3">
                                <button data-audio-id="audio-sec3" class="play-audio-btn bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 inline" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                                    <span class="play-text">Play</span>
                                </button>
                                <span class="time-display text-sm text-gray-600">0:00 / 0:00</span>
                            </div>
                            <div class="w-full">
                                <input type="range" class="audio-seeker w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="0">
                            </div>
                        </div>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2 mt-6">Questions 21-24</h4>
                        <p class="mb-4">Choose the correct letter, <strong>A, B or C</strong>.</p>
                        <div class="space-y-4 p-4 border rounded-lg bg-white mb-6">
                            <div class="q-item">
                                <p><strong>21</strong> What first inspired Jim to choose this project?</p>
                                <label class="block"><input type="radio" name="q21" value="A"> A textiles displayed in an exhibition</label>
                                <label class="block"><input type="radio" name="q21" value="B"> B a book about a botanic garden</label>
                                <label class="block"><input type="radio" name="q21" value="C"> C carpets he saw on holiday</label>
                            </div>
                            <div class="q-item">
                                <p><strong>22</strong> Jim eventually decided to do a practical investigation which involved</p>
                                <label class="block"><input type="radio" name="q22" value="A"> A using a range of dyes with different fibres.</label>
                                <label class="block"><input type="radio" name="q22" value="B"> B applying different dyes to one type of fibre.</label>
                                <label class="block"><input type="radio" name="q22" value="C"> C testing one dye and a range of fibres.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>23</strong> When doing his experiments, Jim was surprised by</p>
                                <label class="block"><input type="radio" name="q23" value="A"> A how much natural material was needed to make the dye.</label>
                                <label class="block"><input type="radio" name="q23" value="B"> B the fact that dyes were widely available on the internet.</label>
                                <label class="block"><input type="radio" name="q23" value="C"> C the time that he had to leave the fabric in the dye.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>24</strong> What problem did Jim have with using tartrazine as a fabric dye?</p>
                                <label class="block"><input type="radio" name="q24" value="A"> A It caused a slight allergic reaction.</label>
                                <label class="block"><input type="radio" name="q24" value="B"> B It was not a permanent dye on cotton.</label>
                                <label class="block"><input type="radio" name="q24" value="C"> C It was ineffective when used on nylon.</label>
                            </div>
                        </div>
                        <h4 class="font-bold mb-2 mt-6">Questions 25-30</h4>
                        <p class="mb-4">What problem is identified with each of the following natural dyes?</p>
                        <p class="mb-4">Choose <strong>SIX answers from the box</strong> and write the correct letter, <strong>A-H</strong>, next to Questions 25-30.</p>
                        <div class="p-4 border rounded-lg bg-gray-50 mb-4">
                            <p class="font-bold mb-2">Problems</p>
                            <p>A It is expensive.</p>
                            <p>B The colour is too strong.</p>
                            <p>C The colour is not long-lasting.</p>
                            <p>D It is very poisonous.</p>
                            <p>E It can damage the fabric.</p>
                            <p>F The colour may be unexpected.</p>
                            <p>G It is unsuitable for some fabrics.</p>
                            <p>H It is not generally available</p>
                        </div>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <div class="q-item">
                                <p><strong>25</strong> turmeric <input type="text" id="q25" data-q="25" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>26</strong> beetroot <input type="text" id="q26" data-q="26" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>27</strong> Tyrian purple <input type="text" id="q27" data-q="27" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>28</strong> logwood <input type="text" id="q28" data-q="28" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>29</strong> cochineal <input type="text" id="q29" data-q="29" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                            <div class="q-item">
                                <p><strong>30</strong> metal oxide <input type="text" id="q30" data-q="30" class="border border-gray-300 rounded px-2 py-1 w-16"></p>
                            </div>
                        </div>
                    `
                },
                {
                    title: "Section 4",
                    instructions: `
                        <h3 class="text-lg font-bold mb-4">Listening Section 4</h3>
                        <p class="mb-4">You will hear a lecture about the sleepy lizard (tiliqua rugosa).</p>
                        <div class="p-4 bg-blue-100 rounded-lg">
                            <p class="font-semibold mb-2">Audio Control</p>
                            <audio id="audio-sec4" src="https://s4-media1.study4.com/media/ielts_media/sound/08_Cam13-Test3-Section4.mp3" preload="metadata"></audio>
                            <div class="flex items-center space-x-3 mb-3">
                                <button data-audio-id="audio-sec4" class="play-audio-btn bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 inline" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                                    <span class="play-text">Play</span>
                                </button>
                                <span class="time-display text-sm text-gray-600">0:00 / 0:00</span>
                            </div>
                            <div class="w-full">
                                <input type="range" class="audio-seeker w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="0">
                            </div>
                        </div>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2 mt-6">Questions 31-40</h4>
                        <p class="mb-4">Complete the notes below. Write <strong>ONE WORD ONLY</strong> for each answer.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <h5 class="font-bold text-center text-lg">The sleepy lizard (tiliqua rugosa)</h5>
                            <p><strong>Description</strong></p>
                            <ul>
                                <li>They are common in Western and South Australia</li>
                                <li>They are brown, but recognisable by their blue <strong>31</strong> <input type="text" id="q31" data-q="31"></li>
                                <li>They are relatively large</li>
                                <li>Their diet consists mainly of <strong>32</strong> <input type="text" id="q32" data-q="32"></li>
                                <li>Their main predators are large birds and <strong>33</strong> <input type="text" id="q33" data-q="33"></li>
                            </ul>
                            <p><strong>Navigation study</strong></p>
                            <ul>
                                <li>One study found that lizards can use the <strong>34</strong> <input type="text" id="q34" data-q="34"> to help them navigate</li>
                            </ul>
                            <p><strong>Observations in the wild</strong></p>
                            <ul>
                                <li>Observations show that these lizards keep the same <strong>35</strong> <input type="text" id="q35" data-q="35"> for several years</li>
                            </ul>
                            <p><strong>What people want</strong></p>
                            <ul>
                                <li>Possible reasons:</li>
                                <li>– to improve the survival of their young</li>
                                <li>(but little <strong>36</strong> <input type="text" id="q36" data-q="36"> has been noted between parents and children)</li>
                                <li>– to provide <strong>37</strong> <input type="text" id="q37" data-q="37"> for female lizards</li>
                            </ul>
                            <p><strong>Tracking study</strong></p>
                            <ul>
                                <li>A study was carried out using GPS systems attached to the <strong>38</strong> <input type="text" id="q38" data-q="38"> of the lizards</li>
                                <li>This provided information on the lizards' location and even the number of <strong>39</strong> <input type="text" id="q39" data-q="39"> taken</li>
                                <li>It appeared that the lizards were trying to avoid one another</li>
                                <li>This may be in order to reduce chances of <strong>40</strong> <input type="text" id="q40" data-q="40"></li>
                            </ul>
                        </div>
                    `
                }
            ]
        },
        reading: {
            duration: 3600, // 60 minutes
            sections: [
                {
                    title: "Passage 1",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">The coconut palm</h3>
                        <p class="mb-4">For millennia, the coconut has been central to the lives of Polynesian and Asian peoples. In the western world, on the other hand, coconuts have always been exotic and unusual, sometimes rare. The Italian merchant traveller Marco Polo apparently saw coconuts in South Asia in the late 13th century, and among the mid-14th-century travel writings of Sir John Mandeville there is mention of 'great Notes of Ynde' (great Nuts of India). Today, images of palm-fringed tropical beaches are clichés in the west to sell holidays, chocolate bars, fizzy drinks and even romance.</p>
                        <p class="mb-4">Typically, we envisage coconuts as brown cannonballs that, when opened, provide sweet white flesh. But we see only part of the fruit and none of the plant from which they come. The coconut palm has a smooth, slender, grey trunk, up to 30 metres tall. This is an important source of timber for building houses, and is increasingly being used as a replacement for endangered hardwoods in the furniture construction industry. The trunk is surmounted by a rosette of leaves, each of which may be up to six metres long. The leaves have hard veins in their centres which, in many parts of the world, are used as brushes after the green part of the leaf has been stripped away. Immature coconut flowers are tightly clustered together among the leaves at the top of the trunk. The flower stems may be tapped for their sap to produce a drink, and the sap can also be reduced by boiling to produce a type of sugar used for cooking.</p>
                        <p class="mb-4">Coconut palms produce as many as seventy fruits per year, weighing more than a kilogram each. The wall of the fruit has three layers: a waterproof outer layer, a fibrous middle layer and a hard, inner layer. The thick fibrous middle layer produces coconut fibre, 'coir', which has numerous uses and is particularly important in manufacturing ropes. The woody innermost layer, the shell, with its three prominent 'eyes', surrounds the seed. An important product obtained from the shell is charcoal, which is widely used in various industries as well as in the home as a cooking fuel. When broken in half, the shells are also used as bowls in many parts of Asia.</p>
                        <p class="mb-4">Inside the shell are the nutrients (endosperm) needed by the developing seed. Initially, the endosperm is a sweetish liquid, coconut water, which is enjoyed as a drink, but also provides the hormones which encourage other plants to grow more rapidly and produce higher yields. As the fruit matures, the coconut water gradually solidifies to form the brilliant white, fat-rich, edible flesh or meat. Dried coconut flesh, 'copra', is made into coconut oil and coconut milk, which are widely used in cooking in different parts of the world, as well as in cosmetics. A derivative of coconut fat, glycerine, acquired strategic importance in a quite different sphere, as Alfred Nobel introduced the world to his nitroglycerine-based invention: dynamite.</p>
                        <p class="mb-4">Their biology would appear to make coconuts the great maritime voyagers and coastal colonizers of the plant world. The large, energy-rich fruits are able to float in water and tolerate salt, but cannot remain viable indefinitely; studies suggest after about 110 days at sea they are no longer able to germinate. Literally cast onto desert island shores, with little more than sand to grow in and exposed to the full glare of the tropical sun, coconut seeds are able to germinate and root. The air pocket in the seed, created as the endosperm solidifies, protects the embryo. In addition, the fibrous fruit wall that helped it to float during the voyage stores moisture that can be taken up by the roots of the coconut seedling as it starts to grow.</p>
                        <p class="mb-4">There have been centuries of academic debate over the origins of the coconut. There were no coconut palms in West Africa, the Caribbean or the east coast of the Americans before the voyages of the European explorers Vasco da Gama and Columbus in the late 15th and early 16th centuries. 16th century trade and human migration patterns reveal that Arab traders and European sailors are likely to have moved coconuts from South and Southeast Asia to Africa and then across the Atlantic to the east coast of America. But the origin of coconuts discovered along the west coast of America by 16th century sailors has been the subject of centuries of discussion. Two diametrically opposed origins have been proposed: that they came from Asia, or that they were native to America. Both suggestions have problems. In Asia, there is a large degree of coconut diversity and evidence of millennia of human use – but there are no relatives growing in the wild. In America, there are close coconut relatives, but no evidence that coconuts are indigenous. These problems have led to the intriguing suggestion that coconuts originated on coral islands in the Pacific and were dispersed from there.</p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 1-8</h4>
                        <p class="mb-4">Complete the table below. Choose <strong>ONE WORD ONLY</strong> from the passage for each answer.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <table class="w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="border border-gray-300 p-2 text-left">Part of coconut palm</th>
                                        <th class="border border-gray-300 p-2 text-left">Use</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border border-gray-300 p-2">trunk</td>
                                        <td class="border border-gray-300 p-2">building houses and <strong>1</strong> <input type="text" id="q41" data-q="41" class="border border-gray-300 rounded px-2 py-1 w-32"></td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">leaves</td>
                                        <td class="border border-gray-300 p-2">making <strong>2</strong> <input type="text" id="q42" data-q="42" class="border border-gray-300 rounded px-2 py-1 w-32"></td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">flower stems</td>
                                        <td class="border border-gray-300 p-2">producing drink and <strong>3</strong> <input type="text" id="q43" data-q="43" class="border border-gray-300 rounded px-2 py-1 w-32"></td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">middle layer</td>
                                        <td class="border border-gray-300 p-2">making <strong>4</strong> <input type="text" id="q44" data-q="44" class="border border-gray-300 rounded px-2 py-1 w-32"> and ropes</td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">shell</td>
                                        <td class="border border-gray-300 p-2">making <strong>5</strong> <input type="text" id="q45" data-q="45" class="border border-gray-300 rounded px-2 py-1 w-32"> and bowls</td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">coconut water</td>
                                        <td class="border border-gray-300 p-2">providing <strong>6</strong> <input type="text" id="q46" data-q="46" class="border border-gray-300 rounded px-2 py-1 w-32"> for other plants</td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">coconut flesh</td>
                                        <td class="border border-gray-300 p-2">making oil, milk and <strong>7</strong> <input type="text" id="q47" data-q="47" class="border border-gray-300 rounded px-2 py-1 w-32"></td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2">coconut fat</td>
                                        <td class="border border-gray-300 p-2">making <strong>8</strong> <input type="text" id="q48" data-q="48" class="border border-gray-300 rounded px-2 py-1 w-32"> for dynamite</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <h4 class="font-bold mb-2">Questions 9-13</h4>
                        <p class="mb-4">Do the following statements agree with the information given in Reading Passage 1? Write <strong>TRUE</strong>, <strong>FALSE</strong>, or <strong>NOT GIVEN</strong>.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <p><strong>9</strong> Coconut seeds need shade in order to germinate. <input type="text" id="q49" data-q="49" class="border border-gray-300 rounded px-2 py-1 w-32"></p>
                            <p><strong>10</strong> Coconuts were probably transported to Asia from America in the 16th century. <input type="text" id="q50" data-q="50" class="border border-gray-300 rounded px-2 py-1 w-32"></p>
                            <p><strong>11</strong> Coconuts found on the west coast of America were a different type from those found on the east coast. <input type="text" id="q51" data-q="51" class="border border-gray-300 rounded px-2 py-1 w-32"></p>
                            <p><strong>12</strong> All the coconuts found in Asia are cultivated varieties. <input type="text" id="q52" data-q="52" class="border border-gray-300 rounded px-2 py-1 w-32"></p>
                            <p><strong>13</strong> Coconuts are cultivated in different ways in America and the Pacific. <input type="text" id="q53" data-q="53" class="border border-gray-300 rounded px-2 py-1 w-32"></p>
                        </div>
                    `
                },
                {
                    title: "Passage 2",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">How baby talk gives infant brains a boost</h3>
                        <p class="mb-4"><strong>A.</strong> The typical way of talking to a baby – high-pitched, exaggerated and repetitious – is a source of fascination for linguists who hope to understand how 'baby talk' impacts on learning. Most babies start developing their hearing while still in the womb, prompting some hopeful parents to play classical music to their pregnant bellies. Some research even suggests that infants are listening to adult speech as early as 10 weeks before being born, gathering the basic building blocks of their family's native tongue.</p>
                        <p class="mb-4"><strong>B.</strong> Early language exposure seems to have benefits to the brain – for instance, studies suggest that babies raised in bilingual homes are better at learning how to mentally prioritize information. So how does the sweet if sometimes absurd sound of infant-directed speech influence a baby's development? Here are some recent studies that explore the science behind baby talk.</p>
                        <p class="mb-4"><strong>C.</strong> Fathers don't use baby talk as often or in the same ways as mothers – and that's perfectly OK, according to a new study. Mark VanDam of Washington State University at Spokane and colleagues equipped parents with recording devices and speech-recognition software to study the way they interacted with their youngsters during a normal day. 'We found that moms do exactly what you'd expect and what's been described many times over,' VanDam explains. 'But we found that dads aren't doing the same thing. Dads didn't raise their pitch or fundamental frequency when they talked to kids.' Their role may be rooted in what is called the bridge hypothesis, which dates back to 1975. It suggests that fathers use less familial language to provide their children with a bridge to the kind of speech they'll hear in public. 'The idea is that a kid gets to practice a certain kind of speech with mom and another kind of speech with dad, so the kid then has a wider repertoire of kinds of speech to practice,' says VanDam.</p>
                        <p class="mb-4"><strong>D.</strong> Scientists from the University of Washington and the University of Connecticut collected thousands of 30-second conversations between parents and their babies, fitting 26 children with audio-recording vests that captured language and sound during a typical eight-hour day. The study found that the more baby talk parents used, the more their youngsters began to babble. And when researchers saw the same babies at age two, they found that frequent baby talk had dramatically boosted vocabulary, regardless of socioeconomic status. 'Those children who listened to a lot of baby talk were talking more than the babies that listened to more adult talk or standard speech,' says Nairán Ramirez-Esparza of the University of Connecticut. 'We also found that it really matters whether you use baby talk in a one-on-one context,' she adds. 'The more parents use baby talk one-on-one, the more babies babble, and the more they babble, the more words they produce later in life.'</p>
                        <p class="mb-4"><strong>E.</strong> Another study suggests that parents might want to pair their youngsters up so they can babble more with their own kind. Researchers from McGill University and Université du Québec à Montréal found that babies seem to like listening to each other rather than to adults – which may be why baby talk is such a universal tool among parents. They played repeating vowel sounds made by a special synthesizing device that mimicked sounds made by either an adult woman or another baby. This way, only the impact of the auditory cues was observed. The team then measured how long each type of sound held the infants' attention. They found that the 'infant' sounds held babies' attention nearly 40 percent longer. The baby noises also induced more reactions in the listening infants, like smiling or lip moving, which approximates sound making. The team theorizes that this attraction to other infant sounds could help launch the learning process that leads to speech. 'It may be some property of the sound that is just drawing their attention,' says study co-author Linda Polka. 'Or maybe they are really interested in that particular type of sound because they are starting to focus on their own ability to make sounds. We are speculating here but it might catch their attention because they recognize it as a sound they could possibly make.'</p>
                        <p class="mb-4"><strong>F.</strong> In a study published in Proceedings of the National Academy of Sciences, a total of 57 babies from two slightly different age groups – seven months and eleven and a half months – were played a number of syllables from both their native language (English) and a non-native tongue (Spanish). The infants were placed in a brain-activation scanner that recorded activity in a brain region known to guide the motor movements that produce speech. The results suggest that listening to baby talk prompts infant brains to start practicing their language skills. 'Finding activation in motor areas the baby brain is engaged in trying to talk back right from the start, and suggests that seven-month-olds' brains are already trying to figure out how to make interesting finding was that while the seven-month-olds responded to all speech sounds regardless of language, the brains of the older infants worked harder at the motor activations of non-native sounds compared to native sounds. The study may have also uncovered a process by which babies recognize differences between their native language and other tongues.</p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 14-17</h4>
                        <p class="mb-4">Look at the following ideas (Questions 14-17) and the list of researchers below. Match each idea with the correct researcher, <strong>A, B or C</strong>.</p>
                        <p class="mb-4">Write the correct letter, <strong>A, B or C</strong>, in boxes 14-17 on your answer sheet.</p>
                        <p class="mb-4"><strong>NB</strong> You may use any letter more than once.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <p><strong>14</strong> the importance of adults giving babies individual attention when talking to them <input type="text" maxlength="1" class="w-10 text-center" id="q54" data-q="54"></p>
                            <p><strong>15</strong> the connection between what babies hear and their own efforts to create speech <input type="text" maxlength="1" class="w-10 text-center" id="q55" data-q="55"></p>
                            <p><strong>16</strong> the advantage for the baby of having two parents each speaking in a different way <input type="text" maxlength="1" class="w-10 text-center" id="q56" data-q="56"></p>
                            <p><strong>17</strong> the connection between the amount of baby talk babies hear and how much vocalising they do themselves <input type="text" maxlength="1" class="w-10 text-center" id="q57" data-q="57"></p>
                        </div>
                        <div class="p-4 border rounded-lg bg-gray-50 mb-6">
                            <p class="font-bold mb-2">List of Researchers</p>
                            <p><strong>A</strong> Mark VanDam</p>
                            <p><strong>B</strong> Nairán Ramirez-Esparza</p>
                            <p><strong>C</strong> Patricia Kuhl</p>
                        </div>
                        <h4 class="font-bold mb-2">Questions 18-23</h4>
                        <p class="mb-4">Complete the summary below. Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer.</p>
                        <p class="mb-4">Write your answers in boxes 18-23 on your answer sheet.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <h5 class="font-bold mb-2">Research into how parents talk to babies</h5>
                            <p>Researchers at Washington State University used <strong>18</strong> <input type="text" id="q58" data-q="58" class="border border-gray-300 rounded px-2 py-1 w-32">, together with specialised computer programs, to analyse how parents interacted with their babies during a normal day. The study revealed that <strong>19</strong> <input type="text" id="q59" data-q="59" class="border border-gray-300 rounded px-2 py-1 w-32"> tended not to modify their ordinary speech patterns when interacting with their babies. According to an idea known as the <strong>20</strong> <input type="text" id="q60" data-q="60" class="border border-gray-300 rounded px-2 py-1 w-32">, they may use a more adult type of speech to prepare infants for the language they will hear outside the family home. According to the researchers, hearing baby talk from one parent and 'normal' language from the other expands the baby's <strong>21</strong> <input type="text" id="q61" data-q="61" class="border border-gray-300 rounded px-2 py-1 w-32"> of types of speech which they can practise.</p>
                            <p>Meanwhile, another study carried out by scientists from the University of Washington and the University of Connecticut recorded speech and sound using special <strong>22</strong> <input type="text" id="q62" data-q="62" class="border border-gray-300 rounded px-2 py-1 w-32"> that the babies were equipped with. When they studied the babies again at age two, they found that those who had heard a lot of baby talk in infancy had a much larger <strong>23</strong> <input type="text" id="q63" data-q="63" class="border border-gray-300 rounded px-2 py-1 w-32"> than those who had not.</p>
                        </div>
                        <h4 class="font-bold mb-2">Questions 24-26</h4>
                        <p class="mb-4">Reading Passage 2 has six paragraphs, <strong>A-F</strong>.</p>
                        <p class="mb-4">Which paragraph contains the following information?</p>
                        <p class="mb-4">Write the correct letter, <strong>A-F</strong>, in boxes 24-26 on your answer sheet.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <p><strong>24</strong> a reference to a change which occurs in babies' brain activity before the end of their first year. <input type="text" maxlength="1" class="w-10 text-center" id="q64" data-q="64"></p>
                            <p><strong>25</strong> an example of what some parents do for their baby's benefit before birth <input type="text" maxlength="1" class="w-10 text-center" id="q65" data-q="65"></p>
                            <p><strong>26</strong> a mention of babies' preference for the sounds that other babies make <input type="text" maxlength="1" class="w-10 text-center" id="q66" data-q="66"></p>
                        </div>
                    `
                },
                {
                    title: "Passage 3",
                    passage: `
                        <h3 class="text-xl font-bold mb-4">Whatever happened to the Harappan Civilisation?</h3>
                        <p class="mb-4">Most managers can identify the major trends of the day, But in the course of conducting research in a number of industries and working directly with companies, we have discovered that managers often fail to recognize the less obvious but profound ways these trends are influencing consumers' aspirations, attitudes, and behaviors. This is especially true of trends that managers view as peripheral to their core markets.</p>
                        <p class="mb-4">Many ignore trends in their innovation strategies or adopt a wait-and-see approach and let competitors take the lead. At a minimum, such responses mean missed profit opportunities. At the extreme, they can jeopardize a company by ceding to rivals the opportunity to transform the industry. The purpose of this article is twofold: to spur managers to think more expansively about how trends could engender new value propositions in their core markets, and to provide some high-level advice on how to make market research and product development personnel more adept at analyzing and exploiting trends.</p>
                        <p class="mb-4">One strategy, known as 'infuse and augment', is to design a product or service that retains most of the attributes and functions of existing products in the category but adds others that address the needs and desires unleashed by a major trend. A case in point in the Poppy range of handbags, which the firm Coach created in response to the economic downturn of 2008. The Coach brand had been a symbol of opulence and luxury for nearly 70 years, and the most obvious reaction to the downturn would have been to lower prices. However, that would have risked cheapening the brand's image. Instead, they initiated a consumer-research project which revealed that customers were eager to lift themselves and the country out of tough times. Using these insights, Coach launched the lower-priced Poppy handbags, which were in vibrant colors, and looked more youthful and playful than conventional Coach products. Creating the sub-brand allowed Coach to avert an across-the-board price cut. In contrast to the many companies that responded to the recession by cutting prices, Coach saw the new consumer mindset as an opportunity for innovation and renewal.</p>
                        <p class="mb-4">A further example of this strategy was supermarket Tesco's response to consumers' growing concerns about the environment. With that in mind, Tesco, one of the world's top five retailers, introduced its Greener Living program, which demonstrates the company's commitment to protecting the environment by involving consumers in ways that produce tangible results. For example, Tesco customers can accumulate points for such activities as reusing bags, recycling cans and printer cartridges, and buying home-insulation materials. Like points earned on regular purchases, these green points can be redeemed for cash. Tesco has not abandoned its traditional retail offering but augmented its business with these innovations, thereby infusing its value proposition with a green streak.</p>
                        <p class="mb-4">A more radical strategy is 'combine and transcend'. This entails combining aspects of the product's existing value proposition with attributes addressing changes arising from a trend, to create a novel experience — one that may land the company in an entirely new market space. At first glance, spending resources to incorporate elements of a seemingly irrelevant trend into ones core offerings sounds like it's hardly worthwhile. But consider Nike's move to integrate the digital revolution into its reputation for high-performance athletic footwear. In 2006, they teamed up with technology company Apple to launch Nike+, a digital sports kit comprising a sensor that attaches to the running shoe and a wireless receiver that connects to the user's iPod. By combining Nike's original value proposition for amateur athletes with one for digital consumers, the Nike+ sports kit and web interface moved the company from a focus on athletic apparel to a new plane of engagement with its customers.</p>
                        <p class="mb-4">A third approach, known as 'counteract and reaffirm', involves developing products or services that stress the values traditionally associated with the category in ways that allow consumers to oppose — or at least temporarily escape from — the aspects of trends they view as undesirable. A product that accomplished this is the ME2, a video game created by Canada's iToys. By reaffirming the toy category's association with physical play, the ME2 counteracted some of the widely perceived negative impacts of digital gaming devices. Like other handheld games, the device featured a host of exciting interactive games, a full-color LCD screen, and advanced 3D graphics. What set it apart was that it incorporated the traditional physical component of children's play: it contained a pedometer, which tracked and awarded points for physical activity (walking, running, biking, skateboarding, climbing stairs). The child could use the points to enhance various virtual skills needed for the video game. The ME2, introduced in mid-2008, catered to kids' huge desire to play video games while countering the negatives, such as associations with lack of exercise and obesity.</p>
                        <p class="mb-4">Once you have gained perspective on how trend-related changes in consumer opinions and behaviors impact on your category, you can determine which of our three innovation strategies to pursue. When your category's basic value proposition continues to be meaningful for consumers influenced by the trend, the infuse-and-augment strategy will allow you to reinvigorate the category. If analysis reveals an increasing disparity between your category and consumers' new focus, your innovations need to transcend the category to integrate the two worlds. Finally, if aspects of the category clash with undesired outcomes of a trend, such as associations with unhealthy lifestyles, there is an opportunity to counteract those changes by reaffirming the core values of your category.</p>
                        <p class="mb-4">Trends — technological, economic, environmental, social, or political — that affect how people perceive the world around them and shape what they expect from products and services present firms with unique opportunities for growth.</p>
                    `,
                    questions: `
                        <h4 class="font-bold mb-2">Questions 27-31</h4>
                        <p class="mb-4">Choose the correct letter, <strong>A, B, C or D</strong>.</p>
                        <p class="mb-4">Write the correct letter in boxes 27-31 on your answer sheet.</p>
                        <div class="space-y-4 p-4 border rounded-lg bg-white mb-6">
                            <div class="q-item">
                                <p><strong>27</strong> In the first paragraph, the writer says that most managers</p>
                                <label class="block"><input type="radio" name="q67" value="A"> A fail to spot the key consumer trends of the moment.</label>
                                <label class="block"><input type="radio" name="q67" value="B"> B make the mistake of focusing only on the principal consumer trends.</label>
                                <label class="block"><input type="radio" name="q67" value="C"> C misinterpret market research data relating to current consumer trends.</label>
                                <label class="block"><input type="radio" name="q67" value="D"> D are unaware of the significant impact that trends have on consumers' lives.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>28</strong> According to the third paragraph, Coach was anxious to</p>
                                <label class="block"><input type="radio" name="q68" value="A"> A follow what some of its competitors were doing.</label>
                                <label class="block"><input type="radio" name="q68" value="B"> B maintain its prices throughout its range.</label>
                                <label class="block"><input type="radio" name="q68" value="C"> C safeguard its reputation as a manufacturer of luxury goods.</label>
                                <label class="block"><input type="radio" name="q68" value="D"> D modify the entire look of its brand to suit the economic climate.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>29</strong> What point is made about Tesco's Greener Living programme?</p>
                                <label class="block"><input type="radio" name="q69" value="A"> A It did not require Tesco to modify its core business activities.</label>
                                <label class="block"><input type="radio" name="q69" value="B"> B It succeeded in attracting a more eco-conscious clientele.</label>
                                <label class="block"><input type="radio" name="q69" value="C"> C Its main aim was to raise consumers' awareness of environmental issues.</label>
                                <label class="block"><input type="radio" name="q69" value="D"> D It was not the first time that Tesco had implemented such an initiative.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>30</strong> What does the writer suggest about Nike's strategy?</p>
                                <label class="block"><input type="radio" name="q70" value="A"> A It was an extremely risky strategy at the time.</label>
                                <label class="block"><input type="radio" name="q70" value="B"> B It was a strategy that only a major company could afford to follow.</label>
                                <label class="block"><input type="radio" name="q70" value="C"> C It was the type of strategy that would not have been possible in the past.</label>
                                <label class="block"><input type="radio" name="q70" value="D"> D It was the kind of strategy which might appear to have few obvious benefits.</label>
                            </div>
                            <div class="q-item">
                                <p><strong>31</strong> What was original about the ME2?</p>
                                <label class="block"><input type="radio" name="q71" value="A"> A It contained technology that had been developed for the sports industry.</label>
                                <label class="block"><input type="radio" name="q71" value="B"> B It appealed to young people who were keen to improve their physical fitness.</label>
                                <label class="block"><input type="radio" name="q71" value="C"> C It took advantage of a current trend for video games with colourful 3D graphics.</label>
                                <label class="block"><input type="radio" name="q71" value="D"> D It was a handheld game that addressed people's concerns about unhealthy lifestyles.</label>
                            </div>
                        </div>
                        <h4 class="font-bold mb-2">Questions 32-37</h4>
                        <p class="mb-4">Look at the following statements (Questions 32-37) and the list of companies below</p>
                        <p class="mb-4">Match each statement with the correct company, <strong>A, B, C or D</strong>.</p>
                        <p class="mb-4">Write the correct letter, <strong>A, B, C or D</strong>, in boxes 32-37 on your answer sheet.</p>
                        <p class="mb-4"><strong>NB</strong> You may use any letter more than once.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white mb-6">
                            <p><strong>32</strong> It turned the notion that its products could have harmful effects to its own advantage. <input type="text" maxlength="1" class="w-10 text-center" id="q72" data-q="72"></p>
                            <p><strong>33</strong> It extended its offering by collaborating with another manufacturer. <input type="text" maxlength="1" class="w-10 text-center" id="q73" data-q="73"></p>
                            <p><strong>34</strong> It implemented an incentive scheme to demonstrate its corporate social responsibility. <input type="text" maxlength="1" class="w-10 text-center" id="q74" data-q="74"></p>
                            <p><strong>35</strong> It discovered that customers had a positive attitude towards dealing with difficult circumstances. <input type="text" maxlength="1" class="w-10 text-center" id="q75" data-q="75"></p>
                            <p><strong>36</strong> It responded to a growing lifestyle trend in an unrelated product sector. <input type="text" maxlength="1" class="w-10 text-center" id="q76" data-q="76"></p>
                            <p><strong>37</strong> It successfully avoided having to charge its customers less for its core products. <input type="text" maxlength="1" class="w-10 text-center" id="q77" data-q="77"></p>
                            <div class="mt-4 p-2 bg-gray-100 rounded">
                                <p class="font-bold">List of companies</p>
                                <p><strong>A</strong> Coach</p>
                                <p><strong>B</strong> Tesco</p>
                                <p><strong>C</strong> Nike</p>
                                <p><strong>D</strong> iToys</p>
                            </div>
                        </div>
                        <h4 class="font-bold mb-2">Questions 38-40</h4>
                        <p class="mb-4">Complete each sentence with the correct ending, <strong>A, B, C or D</strong> below.</p>
                        <p class="mb-4">Write the correct letter, <strong>A, B, C or D</strong>, in boxes 38-40 on your answer sheet.</p>
                        <div class="space-y-3 p-4 border rounded-lg bg-white">
                            <p><strong>38</strong> If there are any trend-related changes impacting on your category, you should <input type="text" maxlength="1" class="w-10 text-center" id="q78" data-q="78"></p>
                            <p><strong>39</strong> If a current trend highlights a negative aspect of your category, you should <input type="text" maxlength="1" class="w-10 text-center" id="q79" data-q="79"></p>
                            <p><strong>40</strong> If the consumers' new focus has an increasing lack of connection with your offering you should <input type="text" maxlength="1" class="w-10 text-center" id="q80" data-q="80"></p>
                            <div class="mt-4 p-2 bg-gray-100 rounded">
                                <p class="font-bold">A</strong> employ a combination of strategies to maintain your consumer base.</p>
                                <p><strong>B</strong> identify the most appropriate innovation strategy to use.</p>
                                <p><strong>C</strong> emphasise your brand's traditional values with the counteract-and-affirm strategy.</p>
                                <p><strong>D</strong> use the combine-and-transcend strategy to integrate the two worlds.</p>
                            </div>
                        </div>
                    `
                }
            ]
        }
    };

    // Listening Script Content
    const listeningScripts = {
        section1: [
            "LINDA: Hello, Linda speaking.",
            "MATT: Oh hi, Linda. This is Matt Brooks. Alex White gave me your number. He said you'd be able to give me some advice about moving to Banford.",
            "LINDA: Yes, Alex did mention you. How can I help?",
            "MATT: Well, first of all – which area to live in?",
            "LINDA: Well, I live in Dalton (Example), which is a really nice suburb – not too expensive, and there's a nice park.",
            "MATT: Sounds good. Do you know how much it would be to rent a two bedroom flat there?",
            "LINDA: Yeah, you should be able to get something reasonable for 850 (Q1) pounds per month. That's what people typically pay. You certainly wouldn't want to pay more than 900 pounds. That doesn't include bills or anything.",
            "MATT: No. That sound alright. I'll definitely have a look there. Are the transport links easy from where you live?",
            "LINDA: Well, I'm very lucky. I work in the city centre so I don't have to use public transport. I go by bike. (Q2)",
            "MATT: Oh, I wish I could do that. Is it safe to cycle around the city?",
            "LINDA: Yes, it's fine. And it keeps me fit. Anyway, driving to work in the city centre would be a nightmare because there's hardly any parking (Q3). And the traffic during the rush hour can be bad.",
            "MATT: I'd be working from home but I'd have to go to London one or two days a week.",
            "LINDA: Oh, that's perfect. Getting to London is no problem. There's a fast train every 30 minutes (Q4) which only takes 45 minutes.",
            "MATT: That's good.",
            "LINDA: Yeah, the train service isn't bad during the week. And they run quite late at night. It's weekends that are a problem (Q5). They're always doing engineering work and you have to take a bus to Hadham and pick up the train there, which is really slow. But other than that, Banford's a great place to live. I've never been happier.",
            "————————",
            "LINDA: There are some nice restaurants in the city centre and a brand new cinema which has only been open a couple of months (Q6). There's a good arts centre too.",
            "MATT: Sounds like Banford's got it all.",
            "LINDA: Yes! We're really lucky. There are lots of really good aspects to living here. The schools are good and the hospital here is one of the best in the country (Q7). Everyone I know who's been there's had a positive experience. Oh, I can give you the name of my dentist too in Bridge Street (Q8), if you're interested. I've been going to him for years and I've never had any problems.",
            "MATT: Oh, OK. Thanks!",
            "LINDA: I'll find his number and send it to you.",
            "MATT: Thanks, that would be really helpful.",
            "LINDA: Are you planning to visit Banford soon?",
            "MATT: Yes. My wife and I are both coming next week. We want to make some appointments with estate agents.",
            "LINDA: I could meet you if you like and show you around.",
            "MATT: Are you sure? We'd really appreciate that.",
            "LINDA: Either a Tuesday or Thursday is good for me, after 5.30. (Q9)",
            "MATT: Thursday's preferable – Tuesday I need to get home before 6 pm.",
            "LINDA: Okay great. Let me know which train your catching and I'll meet you in the cafe outside. You can't miss it. It's opposite the station and next to the museum. (Q10)",
            "MATT: Brilliant. I'll text you next week then. Thanks so much for all the advice.",
            "LINDA: No problem. I'll see you next week."
        ],
        section2: [
            "So if you are one of those people who hasn't found the perfect physical activity yet, here are some things to think about which might help you make the right decision for you. The first question to ask yourself is whether you would enjoy training in a gym. Many people are put off by the idea of having to fit a visit to the gym into their busy day. You often have to go very early or late as some gyms can get very crowded but with regular training you'll see a big difference in a relatively short space of time. (Q11)",
            "Running has become incredibly popular in recent years. That's probably got a lot to do with the fact that it's a very accessible form of exercise that anyone can run even if you could only run a few meters to begin with (Q12). But make sure you get the right shoes. It's worth investing in a high quality pair and they don't come cheap. Another great thing about running is that you can do it at any time of day or night. The only thing that may stop you is snow and ice.",
            "Swimming is another really good way to build fitness. What attracts many people is that you can swim in an indoor pool at any time of year (Q13). On the other hand, it can be quite boring or solitary. It's hard to chat to people while you're swimming lengths.",
            "Cycling has become almost as popular as running in recent years. That's probably because as well as improving their fitness many people say being out in the fresh air in a park or in the countryside can be fun (Q14), provided the conditions are right of course. Only fanatics go out in the wind and rain.",
            "Yoga is a good choice for those of you looking for exercise, which focuses on developing both a healthy mind and body. It's a good way of building strength and with the right instructor there's less chance of hurting yourself than with other more active sports. But don't expect to find it easy. It can be surprisingly challenging, especially for people who aren't very flexible. Getting a personal trainer is a good way to start your fitness program. Obviously there can be significant costs involved. But if you've got someone there to encourage you and help you achieve your goals, you're less likely to give up. Make sure you get someone with a recognised qualification though. Or you could do yourself permanent damage. (Q15&Q16)",
            "—————–",
            "Whatever you do, don't join a gym and you're sure you'll make good use of it. So many people waste lots of money by signing up for membership and then hardly ever go. What happens to their good intentions? I don't think people suddenly stop caring about improving their fitness or decide they have more important things to do. I think people lose interest when they don't think they're making enough progress. That's when they give up hope and stop believing they'll ever achieve their goals. Also, what people sometimes don't realize when they start is that it takes a lot of determination and hard work to keep training week after week, and lots of people don't have that kind of commitment (Q17&Q18). One thing you can do to help yourself is to set manageable goals (Q19), be realistic and don't push yourself too far. Some people advise writing goes down but I think it's better to have a flexible approach. Give yourself a really nice treat every time you reach one of your goals (Q20) and don't get too upset if you experience setbacks. It's a journey. There are bound to be difficulties along the way."
        ],
        section3: [
            "TUTOR: OK, Jim. You wanted to see me about your textile design project.",
            "JIM: That's right. I've been looking at how a range of natural dyes can be used to colour fabrics like cotton and wool.",
            "TUTOR: Why did you choose that topic?",
            "JIM: Well, I got a lot of useful ideas from the museum, you know, at that exhibition of textiles. But I've always been interested in anything to do with colour. Years ago, I went to a carpet shop with my parents when we were on holiday in Turkey, and I remember all the amazing colours. (Q21)",
            "TUTOR: They might not all have been natural dyes.",
            "JIM: Maybe not, but for the project I decided to follow it up. And I found a great book about a botanic garden in California that specialises in plants used for dyes.",
            "TUTOR: OK. So, in your project, you had to include a practical investigation.",
            "JIM: Yeah. At first I couldn't decide on my variables. I was going to just look at one type of fibre for example, like cotton …",
            "TUTOR: … and see how different types of dyes affected it?",
            "JIM: Yes. Then I decided to include others as well, so I looked at cotton and wool and nylon. (Q22)",
            "TUTOR: With just one type of dye?",
            "JIM: Various types, including some that weren't natural, for comparison.",
            "TUTOR: OK.",
            "JIM: So, I did the experiments last week. I used some ready-made natural dyes. I found a website which supplied them, they came in just a few days, but I also made some of my own.",
            "TUTOR: That must have taken quite a bit of time.",
            "JIM: Yes, I'd thought it'd just be a matter of a teaspoon or so of dye, and actually that wasn't the case at all. Like I was using one vegetable, beetroot, for a red dye, and I had to chop up a whole pile of it (Q23). So it all took longer than I'd expected.",
            "TUTOR: One possibility is to use food colourings.",
            "JIM: I did use one. That was a yellow dye, an artificial one.",
            "TUTOR: Tartrazine?",
            "JIM: Yeah. I used it on cotton first. It came out a great colour, but when I rinsed the material, the colour just washed away (Q24). I'd been going to try it out on nylon, but I abandoned that idea.",
            "TUTOR: Were you worried about health issues?",
            "JIM: I'd thought if it's a legal food colouring, it must be safe.",
            "TUTOR: Well, it can occasionally cause allergic reactions, I believe.",
            "———————–",
            "TUTOR: So what natural dyes did you look at?",
            "JIM: Well, one was turmeric. The colour's great, it's a really strong yellow. It's generally used in dishes like curry.",
            "TUTOR: It's meant to be quite good for your health when eaten, but you might find it's not permanent when it's used as a dye – a few washes, and it's gone. (Q25)",
            "JIM: Right. I used beetroot as a dye for wool. When I chop up beetroot to eat I always end up with bright red hands, but the wool ended up just a sort of watery cream shade (Q26). Disappointing.",
            "TUTOR: There's a natural dye called Tyrian purple. Have you heard of that?",
            "JIM: Yes. It comes from a shellfish, and it was worn in ancient times but only by important people as it was so rare. I didn't use it. (Q27)",
            "TUTOR: It fell out of use centuries ago, though one researcher managed to get hold of some recently. But that shade of purple can be produced by chemical dyes nowadays. Did you use any black dyes?",
            "JIM: Logwood. That was quite complicated. I had to prepare the fabric so the dye would take.",
            "TUTOR: I hope you were careful to wear gloves.",
            "JIM: Yes. I know the danger with that dye.",
            "TUTOR: Good. It can be extremely dangerous if it's ingested (Q28). Now, presumably you had a look at an insect-based dye? Like cochineal, for example?",
            "JIM: Yes. I didn't actually make that, I didn't have time to start crushing up insects to get the red colour and anyway they're not available here, but I managed to get the dye quite easily from a website. But it cost a fortune (Q29). I can see why it's generally just used in cooking, and in small quantities.",
            "TUTOR: Yes, it's very effective, but that's precisely why it's not used as a dye.",
            "JIM: I also read about using metal oxide. Apparently you can allow iron to rust while it's in contact with the fabric, and that colours it.",
            "TUTOR: Yes, that works well for dying cotton. But you have to be careful as the metal can actually affect the fabric (Q30) and so you can't expect to get a lot of wear out of fabrics treated in this way. And the colours are quite subtle, not everyone likes them. Anyway, it looks as if you've done a lot of work …"
        ],
        section4: [
            "Last week, we started looking at reptiles, including crocodiles and snakes. Today, I'd like us to have a look at another reptile – the lizard – and in particular, at some studies that have been done on a particular type of lizard whose Latin name is tiliqua rugosa. This is commonly known as the sleepy lizard, because it's quite slow in its movements and spends quite a lot of its time dozing under rocks or lying in the sun.",
            "I'll start with a general description. Sleepy lizards live in Western and South Australia, where they're quite common. Unlike European lizards, which are mostly small, green and fast-moving, sleepy lizards are brown, but what's particularly distinctive about them is the colour of their tongue, which is dark blue (Q31), in contrast with the lining of their mouth which is bright pink. And they're much bigger than most European lizards. They have quite a varied diet, including insects and even small animals, but they mostly eat plants of varying kinds. (Q32)",
            "Even though they're quite large and powerful, with strong jaws that can crush beetles and snail shells, they still have quite a few predators. Large birds like cassowaries were one of the main ones in the past, but nowadays they're more likely to be caught and killed by snakes (Q33). Actually, another threat to their survival isn't a predator at all, but is man-made – quite a large number of sleepy lizards are killed by cars when they're trying to cross highways.",
            "One study carried out by Michael Freake at Flinders University investigated the methods of navigation of these lizards. Though they move slowly, they can travel quite long distances. And he found that even if they were taken some distance away from their home territory, they could usually find their way back home as long as they could see the sky – they didn't need any other landmarks on the ground. (Q34)",
            "———————",
            "Observations of these lizards in the wild have also revealed that their mating habits are quite unusual. Unlike most animals, it seems that they're relatively monogamous, returning to the same partner year after year (Q35). And the male and female also stay together for a long time, both before and after the birth of their young.",
            "It's quite interesting to think about the possible reasons for this. It could be that it's to do with protecting their young – you'd expect them to have a much better chance of survival if they have both parents around. But in fact observers have noted that once the babies have hatched out of their eggs, they have hardly any contact with their parents (Q36). So, there's not really any evidence to support that idea.",
            "Another suggestion's based on the observation that male lizards in monogamous relationships tend to be bigger and stronger than other males. So maybe the male lizards stay around so they can give the female lizards protection from other males (Q37). But again, we're not really sure.",
            "Finally, I'd like to mention another study that involved collecting data by tracking the lizards. I was actually involved in this myself. So we caught some lizards in the wild and we developed a tiny GPS system that would allow us to track them, and we fixed this onto their tails (Q38). Then we set the lizards free again, and we were able to track them for twelve days and gather data, not just about their location, but even about how many steps they took during this period. (Q39)",
            "One surprising thing we discovered from this is that there were far fewer meetings between lizards than we expected – it seems that they were actually trying to avoid one another. So why would that be? Well, again we have no clear evidence, but one hypothesis is that male lizards can cause quite serious injuries to one another, so maybe this avoidance is a way of preventing this (Q40) – of self-preservation, if you like. But we need to collect a lot more data before we can be sure of any of this."
        ]
    };

    const answers = {
        // Listening answers - Cambridge 13 Test 3
        q1: "850", q2: "bike", q3: "parking", q4: "30", q5: "weekends", q6: "cinema", q7: "hospital", q8: "dentist", q9: "Thursday", q10: "café",
        q11: "F", q12: "D", q13: "A", q14: "B", q15: "C", q16: "G", q17: "B", q18: "C", q19: "B", q20: "D",
        q21: "C", q22: "A", q23: "A", q24: "B", q25: "C", q26: "F", q27: "H", q28: "D", q29: "A", q30: "E",
        q31: "tongue", q32: "plants", q33: "snakes", q34: "sky", q35: "partner", q36: "contact", q37: "protection", q38: "tail", q39: "steps", q40: "injury",
        // Reading answers - Cambridge 13 Test 3
        q41: "furniture", q42: "sugar", q43: "ropes", q44: "charcoal", q45: "bowls", q46: "hormones", q47: "cosmetics", q48: "dynamite",
        q49: "false", q50: "false", q51: "not given", q52: "true", q53: "not given",
        q54: "B", q55: "C", q56: "A", q57: "B", q58: "recording devices", q59: "fathers", q60: "bridge hypothesis", q61: "repertoire", q62: "audio-recording vests", q63: "vocabulary", q64: "F", q65: "A", q66: "E",
        q67: "C", q68: "H", q69: "A", q70: "B", q71: "D", q72: "shells", q73: "lake", q74: "rainfall", q75: "grains", q76: "pottery", q77: "B", q78: "A", q79: "D", q80: "A"
    };

    // Vocabulary database for difficult words in reading passages
    const vocabularyDatabase = {
        // Passage 1 - Coconut Palm
        "envisage": {
            pronunciation: "en-VIZ-ij",
            ipa: "/ɪnˈvɪzɪdʒ/",
            definition: "To imagine or visualize something",
            synonyms: ["envision", "imagine", "picture", "conceive"]
        },
        "surmounted": {
            pronunciation: "sər-MOWNT-ed",
            ipa: "/sərˈmaʊntɪd/",
            definition: "Placed on top of or above something",
            synonyms: ["crowned", "topped", "capped", "overlooked"]
        },
        "endosperm": {
            pronunciation: "EN-doh-sperm",
            ipa: "/ˈɛndoʊspɜrm/",
            definition: "The nutritive tissue in seeds",
            synonyms: ["seed tissue", "nutritive material", "embryo food"]
        },
        "glycerine": {
            pronunciation: "GLIS-ər-een",
            ipa: "/ˈglɪsərin/",
            definition: "A sweet, colorless liquid used in various products",
            synonyms: ["glycerol", "sweet liquid", "humectant"]
        },
        "maritime": {
            pronunciation: "MAR-ih-time",
            ipa: "/ˈmærɪtaɪm/",
            definition: "Related to the sea or shipping",
            synonyms: ["marine", "nautical", "seafaring", "oceanic"]
        },
        "viable": {
            pronunciation: "VY-uh-buhl",
            ipa: "/ˈvaɪəbəl/",
            definition: "Capable of living or developing",
            synonyms: ["feasible", "workable", "practical", "achievable"]
        },
        "germinate": {
            pronunciation: "JUR-mih-nate",
            ipa: "/ˈdʒɜrməneɪt/",
            definition: "To begin to grow or develop",
            synonyms: ["sprout", "bud", "develop", "emerge"]
        },
        "diametrically": {
            pronunciation: "dy-uh-MET-rik-lee",
            ipa: "/daɪəˈmɛtrɪkli/",
            definition: "Completely opposite or contrary",
            synonyms: ["opposite", "contrary", "antithetical", "polar"]
        },
        "anointing": {
            pronunciation: "ə-NOINT-ing",
            ipa: "/əˈnɔɪntɪŋ/",
            definition: "The act of applying oil or ointment, especially in a religious ceremony",
            synonyms: ["blessing", "consecrating", "dedicating", "sanctifying"]
        },
        "condiment": {
            pronunciation: "KON-də-mənt",
            ipa: "/ˈkɒndɪmənt/",
            definition: "A substance such as salt, pepper, or spices used to add flavor to food",
            synonyms: ["seasoning", "flavoring", "spice", "sauce"]
        },
        "exotic": {
            pronunciation: "ig-ZOT-ik",
            ipa: "/ɪɡˈzɒtɪk/",
            definition: "Originating in or characteristic of a distant foreign country; unusual and exciting",
            synonyms: ["foreign", "alien", "unusual", "strange"]
        },
        "banquet": {
            pronunciation: "BANG-kwit",
            ipa: "/ˈbæŋkwɪt/",
            definition: "An elaborate and formal meal for many people, often to celebrate something",
            synonyms: ["feast", "dinner", "celebration", "formal meal"]
        },
        "monopoly": {
            pronunciation: "mə-NOP-ə-lee",
            ipa: "/məˈnɒpəli/",
            definition: "Exclusive control of a commodity or service in a particular market",
            synonyms: ["control", "dominance", "exclusive possession", "corner"]
        },
        "exorbitantly": {
            pronunciation: "ig-ZOR-bi-tənt-lee",
            ipa: "/ɪɡˈzɔːrbɪtəntli/",
            definition: "To an excessive or unreasonable degree",
            synonyms: ["excessively", "unreasonably", "extremely", "outrageously"]
        },
        "spurred": {
            pronunciation: "SPURD",
            ipa: "/spɜːrd/",
            definition: "Encouraged or stimulated to do something",
            synonyms: ["encouraged", "motivated", "stimulated", "prompted"]
        },
        "cultivation": {
            pronunciation: "kul-tə-VAY-shən",
            ipa: "/ˌkʌltɪˈveɪʃən/",
            definition: "The action of cultivating land or crops; the process of growing plants",
            synonyms: ["farming", "growing", "agriculture", "tending"]
        },
        "pliable": {
            pronunciation: "PLY-ə-bəl",
            ipa: "/ˈplaɪəbəl/",
            definition: "Easily bent or shaped; flexible",
            synonyms: ["flexible", "bendable", "malleable", "supple"]
        },
        "tribute": {
            pronunciation: "TRIB-yoot",
            ipa: "/ˈtrɪbjuːt/",
            definition: "A payment made periodically by one state or ruler to another, especially as a sign of dependence",
            synonyms: ["payment", "offering", "gift", "homage"]
        },
        "enslaved": {
            pronunciation: "en-SLAYVD",
            ipa: "/ɪnˈsleɪvd/",
            definition: "Made someone a slave; forced into slavery",
            synonyms: ["enslaved", "subjugated", "oppressed", "bonded"]
        },
        "lucrative": {
            pronunciation: "LOO-krə-tiv",
            ipa: "/ˈluːkrətɪv/",
            definition: "Producing a great deal of profit; profitable",
            synonyms: ["profitable", "rewarding", "beneficial", "advantageous"]
        },
        "exhausted": {
            pronunciation: "ig-ZAW-stid",
            ipa: "/ɪɡˈzɔːstɪd/",
            definition: "Completely used up; depleted",
            synonyms: ["depleted", "used up", "drained", "consumed"]
        },
        "superseded": {
            pronunciation: "soo-pər-SEED-id",
            ipa: "/ˌsuːpərˈsiːdɪd/",
            definition: "Replaced by something newer or better",
            synonyms: ["replaced", "supplanted", "succeeded", "displaced"]
        },
        
        // Passage 2 - Oxytocin
        "oxytocin": {
            pronunciation: "ok-si-TOH-sin",
            ipa: "/ˌɒksɪˈtoʊsɪn/",
            definition: "A hormone released by the pituitary gland that causes increased contraction of the uterus during labor",
            synonyms: ["love hormone", "bonding hormone", "cuddle chemical"]
        },
        "pituitary": {
            pronunciation: "pi-TOO-i-ter-ee",
            ipa: "/pɪˈtuːɪtəri/",
            definition: "A pea-sized gland at the base of the brain that controls growth and other glands",
            synonyms: ["master gland", "hypophysis"]
        },
        "reinforce": {
            pronunciation: "ree-in-FORS",
            ipa: "/ˌriːɪnˈfɔːrs/",
            definition: "Strengthen or support, especially with additional material or people",
            synonyms: ["strengthen", "support", "bolster", "enhance"]
        },
        "empathetic": {
            pronunciation: "em-pə-THET-ik",
            ipa: "/ˌempəˈθetɪk/",
            definition: "Showing an ability to understand and share the feelings of another",
            synonyms: ["understanding", "compassionate", "sympathetic", "sensitive"]
        },
        "cooperative": {
            pronunciation: "koh-OP-ər-ə-tiv",
            ipa: "/koʊˈɒpərətɪv/",
            definition: "Involving mutual assistance in working toward a common goal",
            synonyms: ["collaborative", "helpful", "supportive", "teamwork"]
        },
        "groundbreaking": {
            pronunciation: "GROWND-bray-king",
            ipa: "/ˈɡraʊndˌbreɪkɪŋ/",
            definition: "Innovative; pioneering; introducing new ideas or methods",
            synonyms: ["innovative", "pioneering", "revolutionary", "trailblazing"]
        },
        "placebo": {
            pronunciation: "plə-SEE-boh",
            ipa: "/pləˈsiːboʊ/",
            definition: "A harmless pill, medicine, or procedure prescribed more for the psychological benefit than for any physiological effect",
            synonyms: ["dummy treatment", "inactive substance", "control"]
        },
        "charitable": {
            pronunciation: "CHAR-i-tə-bəl",
            ipa: "/ˈtʃærɪtəbəl/",
            definition: "Generous in giving money or other help to those in need",
            synonyms: ["generous", "benevolent", "philanthropic", "kind"]
        },
        "constructively": {
            pronunciation: "kən-STRUK-tiv-lee",
            ipa: "/kənˈstrʌktɪvli/",
            definition: "In a way that serves a useful purpose; helpfully",
            synonyms: ["helpfully", "positively", "productively", "usefully"]
        },
        "contrasting": {
            pronunciation: "kən-TRAS-ting",
            ipa: "/kənˈtræstɪŋ/",
            definition: "Differing strikingly; opposite in nature or character",
            synonyms: ["different", "opposing", "conflicting", "divergent"]
        },
        "disposition": {
            pronunciation: "dis-pə-ZISH-ən",
            ipa: "/ˌdɪspəˈzɪʃən/",
            definition: "A person's inherent qualities of mind and character; temperament",
            synonyms: ["temperament", "nature", "character", "personality"]
        },
        "adept": {
            pronunciation: "ə-DEPT",
            ipa: "/əˈdept/",
            definition: "Very skilled or proficient at something",
            synonyms: ["skilled", "proficient", "expert", "talented"]
        },
        "hypotheses": {
            pronunciation: "hy-POTH-ə-seez",
            ipa: "/haɪˈpɒθəsiːz/",
            definition: "Plural of hypothesis; proposed explanations for a phenomenon",
            synonyms: ["theories", "propositions", "assumptions", "speculations"]
        },
        "perplexing": {
            pronunciation: "pər-PLEK-sing",
            ipa: "/pərˈpleksɪŋ/",
            definition: "Completely baffling; very puzzling",
            synonyms: ["puzzling", "confusing", "bewildering", "mystifying"]
        },
        "co-opted": {
            pronunciation: "koh-OPT-id",
            ipa: "/koʊˈɒptɪd/",
            definition: "Appropriated or taken over for a different purpose",
            synonyms: ["appropriated", "adopted", "utilized", "repurposed"]
        },
        "manifest": {
            pronunciation: "MAN-ə-fest",
            ipa: "/ˈmænəfest/",
            definition: "Display or show (a quality or feeling) by one's acts or appearance",
            synonyms: ["display", "show", "demonstrate", "reveal"]
        },
        
        // Passage 3 - Trends
        "profound": {
            pronunciation: "prə-FOWND",
            ipa: "/prəˈfaʊnd/",
            definition: "Very great or intense; having deep insight or understanding",
            synonyms: ["deep", "intense", "significant", "far-reaching"]
        },
        "peripheral": {
            pronunciation: "pə-RIF-ər-əl",
            ipa: "/pəˈrɪfərəl/",
            definition: "Relating to or situated on the edge or periphery of something",
            synonyms: ["marginal", "secondary", "minor", "unimportant"]
        },
        "jeopardize": {
            pronunciation: "JEP-ər-dyz",
            ipa: "/ˈdʒepərdaɪz/",
            definition: "Put (someone or something) into a situation in which there is a danger of loss, harm, or failure",
            synonyms: ["endanger", "threaten", "risk", "compromise"]
        },
        "engender": {
            pronunciation: "en-JEN-dər",
            ipa: "/ɪnˈdʒendər/",
            definition: "Cause or give rise to (a feeling, situation, or condition)",
            synonyms: ["cause", "create", "generate", "produce"]
        },
        "adept": {
            pronunciation: "ə-DEPT",
            ipa: "/əˈdept/",
            definition: "Very skilled or proficient at something",
            synonyms: ["skilled", "proficient", "expert", "talented"]
        },
        "opulence": {
            pronunciation: "OP-yə-ləns",
            ipa: "/ˈɒpjələns/",
            definition: "Great wealth or luxuriousness",
            synonyms: ["luxury", "wealth", "richness", "splendor"]
        },
        "vibrant": {
            pronunciation: "VY-brənt",
            ipa: "/ˈvaɪbrənt/",
            definition: "Full of energy and enthusiasm; bright and striking",
            synonyms: ["energetic", "lively", "bright", "vivid"]
        },
        "avert": {
            pronunciation: "ə-VURT",
            ipa: "/əˈvɜːrt/",
            definition: "Turn away (one's eyes or thoughts); prevent or ward off (an undesirable occurrence)",
            synonyms: ["prevent", "avoid", "ward off", "deflect"]
        },
        "tangible": {
            pronunciation: "TAN-jə-bəl",
            ipa: "/ˈtændʒəbəl/",
            definition: "Perceptible by touch; clear and definite; real",
            synonyms: ["real", "concrete", "palpable", "substantial"]
        },
        "transcend": {
            pronunciation: "tran-SEND",
            ipa: "/trænˈsend/",
            definition: "Be or go beyond the range or limits of (something abstract, typically a conceptual field or division)",
            synonyms: ["surpass", "exceed", "go beyond", "rise above"]
        },
        "counteract": {
            pronunciation: "kown-tər-AKT",
            ipa: "/ˌkaʊntərˈækt/",
            definition: "Act against (something) in order to reduce its force or neutralize it",
            synonyms: ["oppose", "resist", "neutralize", "offset"]
        },
        "reaffirm": {
            pronunciation: "ree-ə-FURM",
            ipa: "/ˌriːəˈfɜːrm/",
            definition: "State again strongly; confirm the validity of",
            synonyms: ["confirm", "restate", "reassert", "validate"]
        },
        "disparity": {
            pronunciation: "dis-PAR-i-tee",
            ipa: "/dɪˈspærɪti/",
            definition: "A great difference; inequality",
            synonyms: ["difference", "inequality", "gap", "contrast"]
        }
    };

    // Vocabulary Quiz Questions
    const vocabularyQuiz = {
        title: "Vocabulary Quiz",
        description: "Test your understanding of difficult words from the reading passages",
        questions: [
            // Multiple Choice Questions
            {
                id: "vq1",
                type: "multiple_choice",
                question: "What does 'envisage' mean?",
                options: [
                    "To imagine or visualize something",
                    "To destroy completely",
                    "To travel by sea",
                    "To grow rapidly"
                ],
                correct: 0,
                explanation: "Envisage means to imagine or visualize something. It comes from the French word 'envisager' meaning 'to look in the face of'."
            },
            {
                id: "vq2",
                type: "multiple_choice",
                question: "Which word means 'related to the sea or shipping'?",
                options: [
                    "Maritime",
                    "Terrestrial",
                    "Aerial",
                    "Subterranean"
                ],
                correct: 0,
                explanation: "Maritime means related to the sea or shipping. It comes from the Latin 'maritimus' meaning 'of the sea'."
            },
            {
                id: "vq3",
                type: "multiple_choice",
                question: "What is the meaning of 'viable'?",
                options: [
                    "Very expensive",
                    "Capable of living or developing",
                    "Completely empty",
                    "Extremely fast"
                ],
                correct: 1,
                explanation: "Viable means capable of living or developing. It comes from the French 'viable' meaning 'capable of life'."
            },
            {
                id: "vq4",
                type: "multiple_choice",
                question: "Which word means 'completely opposite or contrary'?",
                options: [
                    "Similar",
                    "Diametrically",
                    "Identical",
                    "Parallel"
                ],
                correct: 1,
                explanation: "Diametrically means completely opposite or contrary. It comes from 'diameter' - things at opposite ends of a diameter are completely opposite."
            },
            {
                id: "vq5",
                type: "multiple_choice",
                question: "What does 'germinate' mean?",
                options: [
                    "To destroy seeds",
                    "To begin to grow or develop",
                    "To store for later use",
                    "To cook thoroughly"
                ],
                correct: 1,
                explanation: "Germinate means to begin to grow or develop, especially from a seed. It comes from the Latin 'germinare' meaning 'to sprout'."
            },
            // True/False Questions
            {
                id: "vq6",
                type: "true_false",
                question: "The word 'exotic' means 'originating in or characteristic of a distant foreign country'.",
                correct: true,
                explanation: "True. Exotic means originating in or characteristic of a distant foreign country; unusual and exciting."
            },
            {
                id: "vq7",
                type: "true_false",
                question: "'Monopoly' means 'exclusive control of a commodity or service in a particular market'.",
                correct: true,
                explanation: "True. Monopoly means exclusive control of a commodity or service in a particular market."
            },
            {
                id: "vq8",
                type: "true_false",
                question: "'Exorbitantly' means 'to a reasonable degree'.",
                correct: false,
                explanation: "False. Exorbitantly means to an excessive or unreasonable degree, not reasonable."
            },
            {
                id: "vq9",
                type: "true_false",
                question: "'Lucrative' means 'producing a great deal of profit'.",
                correct: true,
                explanation: "True. Lucrative means producing a great deal of profit; profitable."
            },
            {
                id: "vq10",
                type: "true_false",
                question: "'Superseded' means 'replaced by something newer or better'.",
                correct: true,
                explanation: "True. Superseded means replaced by something newer or better."
            },
            // Gap-filling Questions
            {
                id: "vq11",
                type: "gap_filling",
                question: "Complete the sentence: The coconut palm trunk is __________ by a rosette of leaves.",
                correct: "surmounted",
                suggestions: ["surmounted", "crowned", "topped"],
                explanation: "Surmounted means 'placed on top of or above something'. The trunk is surmounted (topped) by leaves."
            },
            {
                id: "vq12",
                type: "gap_filling",
                question: "Complete the sentence: The __________ tissue in seeds provides nutrients for the developing embryo.",
                correct: "endosperm",
                suggestions: ["endosperm", "nutritive", "embryonic"],
                explanation: "Endosperm is the nutritive tissue in seeds that provides nutrients for the developing embryo."
            },
            {
                id: "vq13",
                type: "gap_filling",
                question: "Complete the sentence: Coconut palms are great __________ voyagers, able to float across oceans.",
                correct: "maritime",
                suggestions: ["maritime", "oceanic", "seafaring"],
                explanation: "Maritime means related to the sea. Coconut palms are great maritime (sea) voyagers."
            },
            {
                id: "vq14",
                type: "gap_filling",
                question: "Complete the sentence: The coconut seeds can __________ and root even in harsh conditions.",
                correct: "germinate",
                suggestions: ["germinate", "sprout", "develop"],
                explanation: "Germinate means to begin to grow or develop. Coconut seeds can germinate (sprout) and root."
            },
            {
                id: "vq15",
                type: "gap_filling",
                question: "Complete the sentence: The two theories about coconut origins are __________ opposed.",
                correct: "diametrically",
                suggestions: ["diametrically", "completely", "totally"],
                explanation: "Diametrically means completely opposite. The two theories are diametrically opposed (completely opposite)."
            },
            // More Multiple Choice Questions
            {
                id: "vq16",
                type: "multiple_choice",
                question: "What does 'oxytocin' refer to?",
                options: [
                    "A type of plant",
                    "A hormone released by the pituitary gland",
                    "A type of food",
                    "A musical instrument"
                ],
                correct: 1,
                explanation: "Oxytocin is a hormone released by the pituitary gland that causes increased contraction of the uterus during labor."
            },
            {
                id: "vq17",
                type: "multiple_choice",
                question: "Which word means 'showing an ability to understand and share the feelings of another'?",
                options: [
                    "Empathetic",
                    "Aggressive",
                    "Indifferent",
                    "Hostile"
                ],
                correct: 0,
                explanation: "Empathetic means showing an ability to understand and share the feelings of another."
            },
            {
                id: "vq18",
                type: "multiple_choice",
                question: "What does 'placebo' mean?",
                options: [
                    "A real medicine",
                    "A harmless pill prescribed for psychological benefit",
                    "A type of surgery",
                    "A medical device"
                ],
                correct: 1,
                explanation: "Placebo is a harmless pill, medicine, or procedure prescribed more for the psychological benefit than for any physiological effect."
            },
            {
                id: "vq19",
                type: "multiple_choice",
                question: "Which word means 'very great or intense; having deep insight'?",
                options: [
                    "Superficial",
                    "Profound",
                    "Shallow",
                    "Simple"
                ],
                correct: 1,
                explanation: "Profound means very great or intense; having deep insight or understanding."
            },
            {
                id: "vq20",
                type: "multiple_choice",
                question: "What does 'jeopardize' mean?",
                options: [
                    "To protect carefully",
                    "To put into a situation of danger or risk",
                    "To celebrate joyfully",
                    "To organize efficiently"
                ],
                correct: 1,
                explanation: "Jeopardize means to put (someone or something) into a situation in which there is a danger of loss, harm, or failure."
            }
        ]
    };

    // Detailed explanations for reading questions
    const readingExplanations = {
        // Reading Passage 1 - The Coconut Palm (Q41-48) - Table completion
        q41: "The passage states: 'This is an important source of timber for building houses, and is increasingly being used as a replacement for endangered hardwoods in the furniture construction industry.' The answer is 'furniture' because the trunk is used for making furniture.",
        q42: "The passage mentions: 'The flower stems may be tapped for their sap to produce a drink, and the sap can also be reduced by boiling to produce a type of sugar used for cooking.' The answer is 'sugar' because the flower stems produce sugar when the sap is boiled.",
        q43: "The passage states: 'The thick fibrous middle layer produces coconut fibre, 'coir', which has numerous uses and is particularly important in manufacturing ropes.' The answer is 'ropes' because the fibrous middle layer produces coir which is used for making ropes.",
        q44: "The passage mentions: 'An important product obtained from the shell is charcoal, which is widely used in various industries as well as in the home as a cooking fuel.' The answer is 'charcoal' because the shell produces charcoal.",
        q45: "The passage states: 'When broken in half, the shells are also used as bowls in many parts of Asia.' The answer is 'bowls' because shells are used as bowls.",
        q46: "The passage mentions: 'Initially, the endosperm is a sweetish liquid, coconut water, which is enjoyed as a drink, but also provides the hormones which encourage other plants to grow more rapidly and produce higher yields.' The answer is 'hormones' because coconut water provides hormones for other plants.",
        q47: "The passage states: 'Dried coconut flesh, 'copra', is made into coconut oil and coconut milk, which are widely used in cooking in different parts of the world, as well as in cosmetics.' The answer is 'cosmetics' because coconut oil and milk are used in cosmetics.",
        q48: "The passage mentions: 'A derivative of coconut fat, glycerine, acquired strategic importance in a quite different sphere, as Alfred Nobel introduced the world to his nitroglycerine-based invention: dynamite.' The answer is 'dynamite' because glycerine is used to make dynamite.",
        
        // Reading Passage 1 (Q49-53) - True/False/Not Given
        q49: "The passage states: 'Literally cast onto desert island shores, with little more than sand to grow in and exposed to the full glare of the tropical sun, coconut seeds are able to germinate and root.' This contradicts the statement that coconut seeds need shade to germinate. The answer is FALSE.",
        q50: "The passage states: '16th century trade and human migration patterns reveal that Arab traders and European sailors are likely to have moved coconuts from South and Southeast Asia to Africa and then across the Atlantic to the east coast of America.' This contradicts the statement that coconuts were transported to Asia from America. The answer is FALSE.",
        q51: "The passage does not provide any information about whether coconuts found on the west coast of America were different from those on the east coast. The answer is NOT GIVEN.",
        q52: "The passage states: 'In Asia, there is a large degree of coconut diversity and evidence of millennia of human use – but there are no relatives growing in the wild.' This suggests that all coconuts in Asia are cultivated varieties. The answer is TRUE.",
        q53: "The passage does not provide any information about different cultivation methods in America and the Pacific. The answer is NOT GIVEN.",
        
        // Reading Passage 2 - How baby talk gives infant brains a boost (Q54-57) - Matching researchers
        q54: "The passage states: 'We also found that it really matters whether you use baby talk in a one-on-one context,' she adds. 'The more parents use baby talk one-on-one, the more babies babble, and the more they babble, the more words they produce later in life.' This is attributed to Nairán Ramirez-Esparza. The answer is B.",
        q55: "The passage mentions: 'The results suggest that listening to baby talk prompts infant brains to start practicing their language skills.' This is from the study by Patricia Kuhl. The answer is C.",
        q56: "The passage states: 'The idea is that a kid gets to practice a certain kind of speech with mom and another kind of speech with dad, so the kid then has a wider repertoire of kinds of speech to practice,' says VanDam. This is attributed to Mark VanDam. The answer is A.",
        q57: "The passage states: 'The study found that the more baby talk parents used, the more their youngsters began to babble.' This is attributed to Nairán Ramirez-Esparza. The answer is B.",
        
        // Reading Passage 2 (Q58-63) - Summary completion
        q58: "The passage states: 'Mark VanDam of Washington State University at Spokane and colleagues equipped parents with recording devices and speech-recognition software to study the way they interacted with their youngsters during a normal day.' The answer is 'recording devices'.",
        q59: "The passage states: 'But we found that dads aren't doing the same thing. Dads didn't raise their pitch or fundamental frequency when they talked to kids.' The answer is 'fathers'.",
        q60: "The passage mentions: 'Their role may be rooted in what is called the bridge hypothesis, which dates back to 1975.' The answer is 'bridge hypothesis'.",
        q61: "The passage states: 'The idea is that a kid gets to practice a certain kind of speech with mom and another kind of speech with dad, so the kid then has a wider repertoire of kinds of speech to practice.' The answer is 'repertoire'.",
        q62: "The passage states: 'Scientists from the University of Washington and the University of Connecticut collected thousands of 30-second conversations between parents and their babies, fitting 26 children with audio-recording vests that captured language and sound during a typical eight-hour day.' The answer is 'audio-recording vests'.",
        q63: "The passage states: 'And when researchers saw the same babies at age two, they found that frequent baby talk had dramatically boosted vocabulary, regardless of socioeconomic status.' The answer is 'vocabulary'.",
        
        // Reading Passage 2 (Q64-66) - Paragraph matching
        q64: "Paragraph F states: 'The results suggest that listening to baby talk prompts infant brains to start practicing their language skills... while the seven-month-olds responded to all speech sounds regardless of language, the brains of the older infants worked harder at the motor activations of non-native sounds compared to native sounds.' This describes a change in brain activity before the end of the first year. The answer is F.",
        q65: "Paragraph A states: 'Most babies start developing their hearing while still in the womb, prompting some hopeful parents to play classical music to their pregnant bellies.' This gives an example of what parents do before birth. The answer is A.",
        q66: "Paragraph E states: 'Researchers from McGill University and Université du Québec à Montréal found that babies seem to like listening to each other rather than to adults... They found that the 'infant' sounds held babies' attention nearly 40 percent longer.' This mentions babies' preference for other babies' sounds. The answer is E.",
        
        // Reading Passage 3 - Whatever happened to the Harappan Civilisation? (Q67-71) - Paragraph matching
        q67: "Paragraph C states: 'Some have claimed that major glacier-fed rivers changed their course, dramatically affecting the water supply and agriculture; or that the cities could not cope with an increasing population, they exhausted their resource base, the trading economy broke down or they succumbed to invasion and conflict; and yet others that climate change caused an environmental change that affected food and water provision.' This contains proposed explanations for the decline. The answer is C.",
        q68: "Paragraph H states: 'By investigating responses to environmental pressures and threats, we can learn from the past to engage with the public, and the relevant governmental and administrative bodies, to be more proactive in issues such as the management and administration of water supply, the balance of urban and rural development, and the importance of preserving cultural heritage in the future.' This refers to present-day applications. The answer is H.",
        q69: "Paragraph A states: 'But their lack of self-imagery – at a time when the Egyptians were carving and painting representations of themselves all over their temples – is only part of the mystery.' This describes a difference between Harappan and Egyptian cultures. The answer is A.",
        q70: "Paragraph B states: 'As populations increased, cities were built that had great baths, craft workshops, palaces and halls laid out in distinct sectors. Houses were arranged in blocks, with wide main streets and narrow alleyways, and many had their own wells and drainage systems.' This describes features of Harappan urban design. The answer is B.",
        q71: "Paragraph D states: 'A research team led by Petrie, together with Dr Ravindanath Singh of Banaras Hindu University in India, found early in their investigations that many of the archaeological sites were not where they were supposed to be, completely altering understanding of the way that this region was inhabited in the past.' This refers to discovery of errors by previous archaeologists. The answer is D.",
        
        // Reading Passage 3 (Q72-76) - Summary completion
        q72: "The passage states: 'The researchers gathered shells of Melanoides tuberculate snails from the sediments of an ancient lake and used geochemical analysis as a means of tracing the climate history of the region.' The answer is 'shells'.",
        q73: "The passage states: 'The researchers gathered shells of Melanoides tuberculate snails from the sediments of an ancient lake.' The answer is 'lake'.",
        q74: "The passage states: 'But we have observed that there was an abrupt change about 4,100 years ago, when the amount of evaporation from the lake exceeded the rainfall – indicative of a drought.' The answer is 'rainfall'.",
        q75: "The passage states: 'They are analysing grains cultivated at the time, and trying to work out whether they were grown under extreme conditions of water stress.' The answer is 'grains'.",
        q76: "The passage states: 'They are also looking at whether the types of pottery used, and other aspects of their material culture, were distinctive to specific regions or were more similar across larger areas.' The answer is 'pottery'.",
        
        // Reading Passage 3 (Q77-80) - Matching researchers
        q77: "The passage states: 'Considering the vast area of the Harappan Civilisation with its variable weather systems,' explains Singh, 'it is essential that we obtain more climate data from areas close to the two great cities at Mohenjodaro and Harappa and also from the Indian Punjab.' This is attributed to Ravindanath Singh. The answer is B.",
        q78: "The passage states: 'Petrie believes that archaeologists are in a unique position to investigate how past societies responded to environmental and climatic change. 'By investigating responses to environmental pressures and threats, we can learn from the past to engage with the public, and the relevant governmental and administrative bodies, to be more proactive in issues such as the management and administration of water supply, the balance of urban and rural development, and the importance of preserving cultural heritage in the future.'' This is attributed to Cameron Petrie. The answer is A.",
        q79: "The passage states: 'Hodell adds: 'We estimate that the weakening of the Indian summer monsoon climate lasted about 200 years before recovering to the previous conditions, which we still see today.'' This is attributed to David Hodell. The answer is D.",
        q80: "The passage states: ''There is plenty of archaeological evidence to tell us about the rise of the Harappan Civilisation, but relatively little about its fall,' explains archaeologist Dr Cameron Petrie of the University of Cambridge.' This is attributed to Cameron Petrie. The answer is A."
    };

    // --- APPLICATION LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        const app = {
            // State
            userAnswers: {},
            currentTab: 'listening',
            currentSection: 0,
            answersChecked: {},
            scriptVisible: false,

            // Elements
            contentPanes: document.getElementById('content-panes'),
            leftPane: document.getElementById('left-pane'),
            rightPane: document.getElementById('right-pane'),
            questionsSection: document.getElementById('questions-section'),
            scriptSection: document.getElementById('script-section'),
            scriptContent: document.getElementById('script-content'),
            splitter: document.getElementById('splitter'),
            sectionTabsContainer: document.getElementById('section-tabs'),
            toggleScriptBtn: document.getElementById('toggle-script-btn'),
            highlightTooltip: document.getElementById('highlight-tooltip'),
            vocabTooltip: document.getElementById('vocab-tooltip'),

            init() {
                this.setupEventListeners();
                this.loadContent();
                this.initSplitter();
                this.initHighlighter();
                this.processVocabulary();
                this.initSpeechSynthesis();
                
                // Initialize script button state for listening
                if (this.currentTab === 'listening') {
                    this.toggleScriptBtn.disabled = false;
                    this.toggleScriptBtn.style.opacity = '1';
                } else {
                    this.toggleScriptBtn.disabled = true;
                    this.toggleScriptBtn.style.opacity = '0.5';
                }
                
                // Ensure script section starts hidden
                this.scriptSection.style.display = 'none';
                this.questionsSection.style.display = 'block';
                this.scriptVisible = false;
            },

            setupEventListeners() {
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                });
                this.toggleScriptBtn.addEventListener('click', () => this.toggleScript());
                this.questionsSection.addEventListener('input', (e) => this.saveAnswer(e));
                this.leftPane.addEventListener('input', (e) => this.saveAnswer(e));
                this.questionsSection.addEventListener('click', (e) => {
                    if (e.target.classList.contains('check-section-btn')) {
                        this.checkSectionAnswers(e.target.dataset.section);
                    } else if (e.target.classList.contains('check-exercise-btn')) {
                        this.checkExerciseAnswers(e.target.dataset.exercise, e.target.dataset.range);
                    } else if (e.target.classList.contains('question-highlight') || e.target.classList.contains('explanation-box')) {
                        this.clearSpecificHighlight(e.target);
                    } else if (e.target.classList.contains('user-highlight')) {
                        this.clearUserHighlight(e.target);
                    } else if (e.target.tagName === 'MARK') {
                        this.clearMarkHighlight(e.target);
                    }
                });
                this.leftPane.addEventListener('click', (e) => {
                    if (e.target.classList.contains('check-section-btn')) {
                        this.checkSectionAnswers(e.target.dataset.section);
                    } else if (e.target.classList.contains('check-exercise-btn')) {
                        this.checkExerciseAnswers(e.target.dataset.exercise, e.target.dataset.range);
                    } else if (e.target.classList.contains('question-highlight') || e.target.classList.contains('explanation-box')) {
                        this.clearSpecificHighlight(e.target);
                    } else if (e.target.classList.contains('user-highlight')) {
                        this.clearUserHighlight(e.target);
                    } else if (e.target.tagName === 'MARK') {
                        this.clearMarkHighlight(e.target);
                    }
                });
                
                // Add click listener for highlighted elements in the right pane
                this.rightPane.addEventListener('click', (e) => {
                    if (e.target.classList.contains('question-highlight') || e.target.classList.contains('explanation-box')) {
                        this.clearSpecificHighlight(e.target);
                    }
                });

                // Add vocabulary tooltip event listeners
                let tooltipTimeout;
                let showTimeout;
                let isTooltipHovered = false;
                let isSelecting = false;

                document.addEventListener('mouseover', (e) => {
                    if (e.target.classList.contains('vocab-word')) {
                        clearTimeout(tooltipTimeout);
                        clearTimeout(showTimeout);
                        
                        // Add delay before showing tooltip to allow text selection
                        showTimeout = setTimeout(() => {
                            if (!isSelecting) {
                                const word = e.target.dataset.word;
                                this.showVocabularyTooltip(word, e.target);
                            }
                        }, 500);
                    }
                });

                document.addEventListener('mouseout', (e) => {
                    if (e.target.classList.contains('vocab-word')) {
                        clearTimeout(showTimeout);
                        // Delay hiding to allow mouse to move to tooltip
                        tooltipTimeout = setTimeout(() => {
                            if (!isTooltipHovered) {
                                this.hideVocabularyTooltip();
                            }
                        }, 300);
                    }
                });

                // Detect text selection to prevent tooltip interference
                document.addEventListener('mousedown', (e) => {
                    if (e.target.classList.contains('vocab-word') || e.target.closest('.reading-passage')) {
                        isSelecting = true;
                        this.hideVocabularyTooltip();
                        
                        // Add visual feedback for text selection
                        const passage = e.target.closest('.reading-passage');
                        if (passage) {
                            passage.classList.add('selecting');
                        }
                    }
                });

                document.addEventListener('mouseup', (e) => {
                    setTimeout(() => {
                        isSelecting = false;
                        
                        // Remove visual feedback
                        const passage = e.target.closest('.reading-passage');
                        if (passage) {
                            passage.classList.remove('selecting');
                        }
                    }, 100);
                });

                // Keep tooltip open when hovering over it
                this.vocabTooltip.addEventListener('mouseenter', () => {
                    clearTimeout(tooltipTimeout);
                    isTooltipHovered = true;
                });

                this.vocabTooltip.addEventListener('mouseleave', () => {
                    isTooltipHovered = false;
                    this.hideVocabularyTooltip();
                });
            },

            saveAnswer(e) {
                if (e.target.id || e.target.name) {
                    const id = e.target.id || e.target.name;
                    
                    if (e.target.type === 'checkbox') {
                        // For checkboxes, collect all checked values
                        const checkboxes = document.querySelectorAll(`input[name="${id}"]:checked`);
                        const values = Array.from(checkboxes).map(cb => cb.value);
                        this.userAnswers[id] = values.join('/');
                    } else {
                        // For radio buttons and text inputs
                        this.userAnswers[id] = e.target.value;
                    }
                }
            },

            restoreAnswers() {
                for (const qId in this.userAnswers) {
                    const value = this.userAnswers[qId];
                    const textInput = document.getElementById(qId);
                    const radioInputs = document.querySelectorAll(`input[name="${qId}"]`);

                    if (textInput) {
                        textInput.value = value;
                    } else if (radioInputs.length > 0) {
                        // Check if these are checkboxes (multiple values) or radio buttons (single value)
                        if (value.includes('/')) {
                            // Multiple values for checkboxes
                            const values = value.split('/');
                            radioInputs.forEach(input => {
                                input.checked = values.includes(input.value);
                            });
                        } else {
                            // Single value for radio buttons
                            radioInputs.forEach(radio => {
                                radio.checked = radio.value === value;
                            });
                        }
                    }
                }
            },

            checkSectionAnswers(sectionKey) {
                if (this.answersChecked[sectionKey]) {
                    // Reset answers for this section
                    this.answersChecked[sectionKey] = false;
                    this.loadContent();
                    return;
                }

                // Check answers for this section
                this.answersChecked[sectionKey] = true;
                this.showSectionAnswers(sectionKey);
            },

            checkExerciseAnswers(exerciseKey, range) {
                // Check if answers have already been checked for this exercise
                if (this.answersChecked[exerciseKey]) {
                    // Reset answers for this exercise
                    this.answersChecked[exerciseKey] = false;
                    
                    // Update button text back to "Check Answers"
                    const button = document.querySelector(`[data-exercise="${exerciseKey}"]`);
                    if (button) {
                        button.textContent = 'Check Answers';
                        button.className = 'check-exercise-btn bg-green-600 text-white font-bold py-2 px-6 rounded-md hover:bg-green-700 transition-colors';
                    }
                    
                    this.loadContent(); // Reload to reset the display
                    return;
                }

                // Check answers for this exercise
                this.answersChecked[exerciseKey] = true;
                this.showExerciseAnswers(exerciseKey, range);
                
                // Update button text to "Reset Answers"
                const button = document.querySelector(`[data-exercise="${exerciseKey}"]`);
                if (button) {
                    button.textContent = 'Reset Answers';
                    button.className = 'check-exercise-btn bg-gray-600 text-white font-bold py-2 px-6 rounded-md hover:bg-gray-700 transition-colors';
                }
            },

            switchTab(tabName) {
                this.currentTab = tabName;
                this.currentSection = 0;
                
                // Hide script when switching to reading
                if (tabName === 'reading') {
                    this.scriptVisible = false;
                    this.scriptSection.style.display = 'none';
                    this.questionsSection.style.display = 'block';
                    this.toggleScriptBtn.textContent = 'Show Script';
                    this.toggleScriptBtn.className = 'bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors';
                    this.toggleScriptBtn.disabled = true;
                    this.toggleScriptBtn.style.opacity = '0.5';
                } else if (tabName === 'vocabulary') {
                    // Hide script and questions for vocabulary quiz
                    this.scriptVisible = false;
                    this.scriptSection.style.display = 'none';
                    this.questionsSection.style.display = 'none';
                    this.toggleScriptBtn.disabled = true;
                    this.toggleScriptBtn.style.opacity = '0.5';
                } else {
                    // Enable script button for listening
                    this.toggleScriptBtn.disabled = false;
                    this.toggleScriptBtn.style.opacity = '1';
                    // Ensure script is hidden initially when switching to listening
                    this.scriptVisible = false;
                    this.scriptSection.style.display = 'none';
                    this.questionsSection.style.display = 'none';
                }
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.tab === tabName);
                });
                this.loadContent();
            },
            
            switchSection(sectionIndex) {
                 this.currentSection = sectionIndex;
                 this.loadContent();
            },

            toggleScript() {
                // Only allow script toggle for listening sections
                if (this.currentTab !== 'listening') {
                    console.log('Script toggle blocked - not in listening mode');
                    return;
                }
                
                console.log('Toggling script, current state:', this.scriptVisible);
                this.scriptVisible = !this.scriptVisible;
                
                if (this.scriptVisible) {
                    console.log('Showing script');
                    this.scriptSection.style.display = 'flex';
                    this.scriptSection.style.flexDirection = 'column';
                    this.questionsSection.style.display = 'none';
                    this.toggleScriptBtn.textContent = 'Hide Script';
                    this.toggleScriptBtn.className = 'bg-gray-600 text-white font-bold py-2 px-4 rounded-md hover:bg-gray-700 transition-colors';
                    this.loadScriptContent();
                } else {
                    console.log('Hiding script');
                    this.scriptSection.style.display = 'none';
                    this.questionsSection.style.display = 'block';
                    this.toggleScriptBtn.textContent = 'Show Script';
                    this.toggleScriptBtn.className = 'bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors';
                }
            },

            clearSpecificHighlight(element) {
                if (element.classList.contains('question-highlight')) {
                    // For question highlights in script, just remove the highlight styling
                    element.classList.remove('question-highlight');
                    element.style.backgroundColor = '';
                    element.style.border = '';
                    element.style.padding = '';
                    element.style.borderRadius = '';
                    element.style.boxShadow = '';
                    element.style.cursor = '';
                    element.style.transition = '';
                } else if (element.classList.contains('explanation-box')) {
                    // For explanation boxes, remove the entire box
                    element.remove();
                }
            },

            clearMarkHighlight(element) {
                // Remove the mark element and restore original text
                const parent = element.parentNode;
                const text = element.textContent;
                parent.replaceChild(document.createTextNode(text), element);
                parent.normalize();
            },

            processVocabulary() {
                // Process vocabulary words in reading passages
                const readingPassages = document.querySelectorAll('.reading-passage');
                readingPassages.forEach(passage => {
                    this.addVocabularyTooltips(passage);
                });
            },

            addVocabularyTooltips(container) {
                const walker = document.createTreeWalker(
                    container,
                    NodeFilter.SHOW_TEXT,
                    null,
                    false
                );

                const textNodes = [];
                let node;
                while (node = walker.nextNode()) {
                    textNodes.push(node);
                }

                textNodes.forEach(textNode => {
                    const text = textNode.textContent;
                    const words = text.split(/(\s+)/);
                    const newContent = words.map(word => {
                        const cleanWord = word.toLowerCase().replace(/[^\w]/g, '');
                        if (vocabularyDatabase[cleanWord]) {
                            return `<span class="vocab-word" data-word="${cleanWord}">${word}</span>`;
                        }
                        return word;
                    }).join('');

                    if (newContent !== text) {
                        const wrapper = document.createElement('div');
                        wrapper.innerHTML = newContent;
                        textNode.parentNode.replaceChild(wrapper, textNode);
                    }
                });
            },

            showVocabularyTooltip(word, element) {
                const vocabData = vocabularyDatabase[word];
                if (!vocabData) return;

                const tooltip = this.vocabTooltip;
                const wordDisplay = tooltip.querySelector('.vocab-word-display');
                const audioBtn = tooltip.querySelector('.vocab-audio-btn');
                const pronunciation = tooltip.querySelector('.vocab-pronunciation');
                const ipa = tooltip.querySelector('.vocab-ipa');
                const definition = tooltip.querySelector('.vocab-definition');
                const synonymsList = tooltip.querySelector('.vocab-synonyms-list');

                wordDisplay.textContent = word;
                pronunciation.textContent = vocabData.pronunciation;
                ipa.textContent = vocabData.ipa;
                definition.textContent = vocabData.definition;
                synonymsList.textContent = vocabData.synonyms.join(', ');

                // Set up audio button
                audioBtn.onclick = () => this.playWordPronunciation(word);
                audioBtn.classList.remove('playing');

                // Position tooltip to avoid overlapping with text
                const rect = element.getBoundingClientRect();
                const tooltipRect = tooltip.getBoundingClientRect();
                
                // Try to position to the right first, then left, then above
                let left, top;
                const spaceRight = window.innerWidth - rect.right;
                const spaceLeft = rect.left;
                const spaceAbove = rect.top;
                const spaceBelow = window.innerHeight - rect.bottom;
                
                if (spaceRight >= tooltipRect.width + 20) {
                    // Position to the right
                    left = rect.right + 15;
                    top = rect.top + (rect.height / 2) - (tooltipRect.height / 2);
                    tooltip.style.transform = 'translateY(0)';
                } else if (spaceLeft >= tooltipRect.width + 20) {
                    // Position to the left
                    left = rect.left - tooltipRect.width - 15;
                    top = rect.top + (rect.height / 2) - (tooltipRect.height / 2);
                    tooltip.style.transform = 'translateY(0)';
                } else if (spaceAbove >= tooltipRect.height + 20) {
                    // Position above
                    left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                    top = rect.top - tooltipRect.height - 15;
                    tooltip.style.transform = 'translateY(-10px)';
                } else {
                    // Position below
                    left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                    top = rect.bottom + 15;
                    tooltip.style.transform = 'translateY(10px)';
                }

                // Adjust if tooltip goes off screen
                if (left < 10) left = 10;
                if (left + tooltipRect.width > window.innerWidth - 10) {
                    left = window.innerWidth - tooltipRect.width - 10;
                }
                if (top < 10) top = 10;
                if (top + tooltipRect.height > window.innerHeight - 10) {
                    top = window.innerHeight - tooltipRect.height - 10;
                }

                tooltip.style.left = left + 'px';
                tooltip.style.top = top + 'px';
                tooltip.classList.add('show');
            },

            hideVocabularyTooltip() {
                this.vocabTooltip.classList.remove('show');
            },


            initSpeechSynthesis() {
                // Load voices when they become available
                if ('speechSynthesis' in window) {
                    // Some browsers load voices asynchronously
                    const loadVoices = () => {
                        const voices = speechSynthesis.getVoices();
                        console.log('Available voices:', voices.length);
                    };

                    // Load voices immediately if available
                    loadVoices();

                    // Load voices when they become available
                    speechSynthesis.addEventListener('voiceschanged', loadVoices);
                }
            },

            playWordPronunciation(word) {
                // Check if speech synthesis is supported
                if (!('speechSynthesis' in window)) {
                    console.warn('Speech synthesis not supported');
                    return;
                }

                const audioBtn = this.vocabTooltip.querySelector('.vocab-audio-btn');
                const vocabData = vocabularyDatabase[word];
                
                if (!vocabData) return;

                // Stop any current speech
                speechSynthesis.cancel();

                // Create speech synthesis utterance
                const utterance = new SpeechSynthesisUtterance(word);
                
                // Configure speech settings
                utterance.rate = 0.8; // Slightly slower for clarity
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                utterance.lang = 'en-US';

                // Try to use a high-quality voice
                const voices = speechSynthesis.getVoices();
                const preferredVoices = ['Google US English', 'Microsoft Zira Desktop', 'Alex', 'Samantha'];
                
                for (const preferredVoice of preferredVoices) {
                    const voice = voices.find(v => v.name.includes(preferredVoice));
                    if (voice) {
                        utterance.voice = voice;
                        break;
                    }
                }

                // Add visual feedback
                audioBtn.classList.add('playing');
                audioBtn.textContent = '⏸️';

                // Handle speech events
                utterance.onstart = () => {
                    audioBtn.classList.add('playing');
                    audioBtn.textContent = '⏸️';
                };

                utterance.onend = () => {
                    audioBtn.classList.remove('playing');
                    audioBtn.textContent = '🔊';
                };

                utterance.onerror = () => {
                    audioBtn.classList.remove('playing');
                    audioBtn.textContent = '🔊';
                    console.warn('Speech synthesis error');
                };

                // Speak the word
                speechSynthesis.speak(utterance);
            },

            clearHighlights() {
                // Remove all highlight marks from both panes
                const marks = document.querySelectorAll('mark');
                marks.forEach(mark => {
                    const parent = mark.parentNode;
                    parent.replaceChild(document.createTextNode(mark.textContent), mark);
                    parent.normalize();
                });
                
                // Remove explanation boxes
                const explanations = document.querySelectorAll('.explanation-box');
                explanations.forEach(explanation => explanation.remove());
                
                // Reset answer highlighting
                const inputs = document.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    input.classList.remove('correct-answer', 'incorrect-answer');
                    input.style.backgroundColor = '';
                    input.style.borderColor = '';
                    input.placeholder = '';
                });
                
                // Note: We intentionally do NOT reset button states here
                // The "Clear Highlights" button should only clear visual highlights,
                // not reset the checked state of exercises
            },

            loadScriptContent() {
                const sectionKey = `section${this.currentSection + 1}`;
                console.log('Loading script for section:', sectionKey);
                const script = listeningScripts[sectionKey];
                console.log('Script found:', script);
                
                if (script) {
                    this.scriptContent.innerHTML = script.map(line => {
                        // Highlight question references (Q1), (Q2), etc.
                        const highlightedLine = line.replace(/\(Q\d+\)/g, '<span class="question-highlight" title="Click to remove highlight">$&</span>');
                        return `<div class="mb-2 p-2 bg-white rounded border-l-4 border-purple-400">${highlightedLine}</div>`;
                    }).join('');
                    console.log('Script content loaded');
                } else {
                    this.scriptContent.innerHTML = '<div class="text-gray-500">No script available for this section.</div>';
                    console.log('No script found for section:', sectionKey);
                }
            },

            loadContent() {
                if (this.currentTab === 'vocabulary') {
                    this.loadVocabularyQuiz();
                    return;
                }
                
                const data = testData[this.currentTab];
                const sectionData = data.sections[this.currentSection];

                if (this.currentTab === 'listening') {
                    // --- Two Column Layout for Listening ---
                    this.contentPanes.style.gridTemplateColumns = '1fr 5px 1fr';
                    this.leftPane.style.display = 'block';
                    this.splitter.style.display = 'block';
                    
                    // Load content: left pane has instructions + questions, right pane has script
                    this.leftPane.innerHTML = `
                        <div class="space-y-6">
                            ${sectionData.instructions}
                            ${sectionData.questions}
                        </div>
                    `;
                    this.questionsSection.innerHTML = ''; // Clear questions section since they're in left pane
                } else { // 'reading' tab
                    // --- Two Column Layout for Reading ---
                    this.contentPanes.style.gridTemplateColumns = '1fr 5px 1fr';
                    this.leftPane.style.display = 'block';
                    this.splitter.style.display = 'block';

                    // Load content into separate panes
                    if (sectionData.passage) {
                        this.leftPane.innerHTML = `<div class="reading-passage">${sectionData.passage}</div>`;
                    } else {
                        this.leftPane.innerHTML = sectionData.instructions;
                    }
                    this.questionsSection.innerHTML = sectionData.questions;
                }

                // Generate section buttons
                this.sectionTabsContainer.innerHTML = data.sections.map((sec, index) =>
                    `<button class="section-btn ${index === this.currentSection ? 'active' : ''}" data-section-index="${index}">${sec.title}</button>`
                ).join('');
                
                // Add event listeners to new section buttons
                this.sectionTabsContainer.querySelectorAll('.section-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchSection(parseInt(e.target.dataset.sectionIndex)));
                });
                
                // Add event listeners for audio controls
                document.querySelectorAll('.play-audio-btn').forEach(btn => {
                    const audioId = btn.dataset.audioId;
                    const audioEl = document.getElementById(audioId);
                    const timeDisplay = btn.parentElement.querySelector('.time-display');
                    const seeker = btn.parentElement.parentElement.querySelector('.audio-seeker');
                    const playText = btn.querySelector('.play-text');
                    
                    if (audioEl && timeDisplay && seeker) {
                        // Format time helper
                        const formatTime = (seconds) => {
                            const mins = Math.floor(seconds / 60);
                            const secs = Math.floor(seconds % 60);
                            return `${mins}:${secs.toString().padStart(2, '0')}`;
                        };
                        
                        // Update time display
                        const updateTime = () => {
                            const current = audioEl.currentTime;
                            const duration = audioEl.duration;
                            timeDisplay.textContent = `${formatTime(current)} / ${formatTime(duration)}`;
                            if (duration) {
                                seeker.value = (current / duration) * 100;
                            }
                        };
                        
                        // Play/Pause button
                        btn.addEventListener('click', () => {
                            if (audioEl.paused) {
                                audioEl.play();
                                playText.textContent = 'Pause';
                            } else {
                                audioEl.pause();
                                playText.textContent = 'Play';
                            }
                        });
                        
                        // Seeker bar
                        seeker.addEventListener('input', () => {
                            const duration = audioEl.duration;
                            if (duration) {
                                audioEl.currentTime = (seeker.value / 100) * duration;
                            }
                        });
                        
                        // Audio events
                        audioEl.addEventListener('loadedmetadata', () => {
                            updateTime();
                        });
                        
                        audioEl.addEventListener('timeupdate', updateTime);
                        
                        audioEl.addEventListener('ended', () => {
                            playText.textContent = 'Play';
                            seeker.value = 0;
                            updateTime();
                        });
                        
                        audioEl.addEventListener('pause', () => {
                            playText.textContent = 'Play';
                        });
                        
                        audioEl.addEventListener('play', () => {
                            playText.textContent = 'Pause';
                        });
                    }
                });

                this.restoreAnswers();
                
                // Add check answers button after questions
                this.addCheckAnswersButton();
                
                // Show answers if they have been checked for this section
                const sectionKey = `${this.currentTab}_${this.currentSection}`;
                if (this.answersChecked[sectionKey]) {
                    this.showSectionAnswers(sectionKey);
                }
                
                // For reading, also show answers for individual exercises that have been checked
                if (this.currentTab === 'reading') {
                    const exerciseTypes = this.getReadingExerciseTypes();
                    exerciseTypes.forEach(exercise => {
                        const exerciseKey = `${sectionKey}_${exercise.type}`;
                        if (this.answersChecked[exerciseKey]) {
                            this.showExerciseAnswers(exerciseKey, `${exercise.startQ}-${exercise.endQ}`);
                        }
                    });
                }
                
                // Load script content if script is visible
                if (this.scriptVisible) {
                    this.loadScriptContent();
                }

                // Process vocabulary for reading passages
                if (this.currentTab === 'reading') {
                    setTimeout(() => this.processVocabulary(), 100);
                }
            },

            loadVocabularyQuiz() {
                // Single column layout for vocabulary quiz
                this.contentPanes.style.gridTemplateColumns = '1fr';
                this.leftPane.style.display = 'block';
                this.splitter.style.display = 'none';
                this.questionsSection.style.display = 'none';
                
                // Hide section tabs for vocabulary quiz
                this.sectionTabsContainer.innerHTML = '';
                
                // Initialize quiz state
                this.currentQuizQuestion = 0;
                this.quizScore = 0;
                this.quizAnswers = [];
                
                // Generate vocabulary quiz HTML
                const quizHTML = this.generateVocabularyQuizHTML();
                this.leftPane.innerHTML = quizHTML;
                
                // Add event listeners for quiz interactions
                this.setupVocabularyQuizListeners();
                
                // Show first question
                this.showCurrentQuestion();
            },

            generateVocabularyQuizHTML() {
                let html = `
                    <div class="max-w-4xl mx-auto p-6">
                        <div class="text-center mb-8">
                            <h2 class="text-3xl font-bold text-blue-600 mb-4">${vocabularyQuiz.title}</h2>
                            <p class="text-lg text-gray-600 mb-6">${vocabularyQuiz.description}</p>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                <p class="text-blue-800"><strong>Instructions:</strong> Answer each question to test your vocabulary knowledge. You'll get immediate feedback and move to the next question automatically.</p>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="mb-8">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-gray-700">Progress</span>
                                <span id="quiz-progress" class="text-sm font-medium text-gray-700">0 / ${vocabularyQuiz.questions.length}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div id="quiz-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <!-- Question Container -->
                        <div id="question-container" class="min-h-96">
                            <!-- Questions will be loaded here dynamically -->
                        </div>
                        
                        <!-- Results Container -->
                        <div id="vocab-results" class="mt-8 hidden">
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Quiz Results</h3>
                                <div id="vocab-score" class="text-2xl font-bold text-blue-600 mb-4"></div>
                                <div id="vocab-feedback" class="text-gray-700 mb-4"></div>
                                <button id="restart-quiz" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors">
                                    Take Quiz Again
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                return html;
            },

            generateQuestionHTML(question, questionNumber) {
                let html = `
                    <div class="bg-white border border-gray-200 rounded-lg p-8 shadow-lg">
                        <div class="flex items-start space-x-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-lg">
                                ${questionNumber}
                            </div>
                            <div class="flex-1">
                                <h4 class="text-xl font-semibold text-gray-800 mb-6">${question.question}</h4>
                `;
                
                if (question.type === 'multiple_choice') {
                    html += '<div class="space-y-3">';
                    question.options.forEach((option, index) => {
                        html += `
                            <label class="flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                <input type="radio" name="${question.id}" value="${index}" class="vocab-answer">
                                <span class="text-gray-700 text-lg">${String.fromCharCode(65 + index)}. ${option}</span>
                            </label>
                        `;
                    });
                    html += '</div>';
                } else if (question.type === 'true_false') {
                    html += `
                        <div class="space-y-3">
                            <label class="flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                <input type="radio" name="${question.id}" value="true" class="vocab-answer">
                                <span class="text-gray-700 text-lg">True</span>
                            </label>
                            <label class="flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                <input type="radio" name="${question.id}" value="false" class="vocab-answer">
                                <span class="text-gray-700 text-lg">False</span>
                            </label>
                        </div>
                    `;
                } else if (question.type === 'gap_filling') {
                    html += `
                        <div class="mt-4">
                            <div class="space-y-3">
                                <p class="text-sm text-gray-600 mb-3">Choose the correct word to complete the sentence:</p>
                    `;
                    
                    // Shuffle suggestions to randomize order
                    const shuffledSuggestions = [...question.suggestions].sort(() => Math.random() - 0.5);
                    
                    shuffledSuggestions.forEach((suggestion, index) => {
                        html += `
                            <label class="flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                <input type="radio" name="${question.id}" value="${suggestion}" class="vocab-answer">
                                <span class="text-gray-700 text-lg">${suggestion}</span>
                            </label>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                }
                
                html += `
                            </div>
                        </div>
                        <div id="explanation-${question.id}" class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg hidden">
                            <h5 class="font-semibold text-gray-800 mb-2">Explanation:</h5>
                            <p class="text-gray-700">${question.explanation}</p>
                        </div>
                        <div id="next-question-btn" class="mt-6 text-center hidden">
                            <button class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-colors text-lg">
                                Next Question
                            </button>
                        </div>
                    </div>
                `;
                
                return html;
            },

            setupVocabularyQuizListeners() {
                // Restart quiz button
                document.getElementById('restart-quiz').addEventListener('click', () => {
                    this.loadVocabularyQuiz();
                });
            },

            showCurrentQuestion() {
                const questions = vocabularyQuiz.questions;
                const currentQuestion = questions[this.currentQuizQuestion];
                const questionNumber = this.currentQuizQuestion + 1;
                
                // Update progress
                this.updateProgress();
                
                // Generate and display current question
                const questionHTML = this.generateQuestionHTML(currentQuestion, questionNumber);
                document.getElementById('question-container').innerHTML = questionHTML;
                
                // Add event listeners for current question
                this.setupCurrentQuestionListeners(currentQuestion);
            },

            updateProgress() {
                const progress = ((this.currentQuizQuestion + 1) / vocabularyQuiz.questions.length) * 100;
                document.getElementById('quiz-progress').textContent = `${this.currentQuizQuestion + 1} / ${vocabularyQuiz.questions.length}`;
                document.getElementById('quiz-progress-bar').style.width = `${progress}%`;
            },

            setupCurrentQuestionListeners(question) {
                // For all question types (including gap-filling with suggestions), add radio button listeners
                const inputs = document.querySelectorAll(`input[name="${question.id}"]`);
                inputs.forEach(input => {
                    input.addEventListener('change', () => {
                        this.handleMultipleChoiceAnswer(question);
                    });
                });
                
                // Next question button listener
                document.getElementById('next-question-btn').addEventListener('click', () => {
                    this.nextQuestion();
                });
            },

            handleMultipleChoiceAnswer(question) {
                const userAnswer = this.getUserAnswer(question);
                const isCorrect = this.checkAnswer(question, userAnswer);
                
                // Store the answer
                this.quizAnswers.push({
                    question: question,
                    userAnswer: userAnswer,
                    isCorrect: isCorrect
                });
                
                if (isCorrect) {
                    this.quizScore++;
                }
                
                // Show feedback immediately
                this.showQuestionFeedback(question, userAnswer, isCorrect);
                
                // Auto-advance after a short delay
                setTimeout(() => {
                    this.nextQuestion();
                }, 2000);
            },


            showQuestionFeedback(question, userAnswer, isCorrect) {
                const explanationDiv = document.getElementById(`explanation-${question.id}`);
                const inputs = document.querySelectorAll(`input[name="${question.id}"]`);
                
                // Show explanation
                explanationDiv.classList.remove('hidden');
                
                // Style the inputs based on correctness
                inputs.forEach(input => {
                    const label = input.closest('label');
                    if (input.checked) {
                        if (isCorrect) {
                            label.classList.add('border-green-500', 'bg-green-50');
                            label.classList.remove('border-gray-200');
                        } else {
                            label.classList.add('border-red-500', 'bg-red-50');
                            label.classList.remove('border-gray-200');
                        }
                    }
                });
                
                // Disable all inputs
                inputs.forEach(input => {
                    input.disabled = true;
                });
            },

            nextQuestion() {
                this.currentQuizQuestion++;
                
                if (this.currentQuizQuestion >= vocabularyQuiz.questions.length) {
                    // Quiz completed, show results
                    this.showQuizResults();
                } else {
                    // Show next question
                    this.showCurrentQuestion();
                }
            },

            getUserAnswer(question) {
                const inputs = document.querySelectorAll(`input[name="${question.id}"]`);
                
                if (question.type === 'multiple_choice') {
                    for (let input of inputs) {
                        if (input.checked) {
                            return parseInt(input.value);
                        }
                    }
                } else if (question.type === 'true_false') {
                    for (let input of inputs) {
                        if (input.checked) {
                            return input.value === 'true';
                        }
                    }
                } else if (question.type === 'gap_filling') {
                    for (let input of inputs) {
                        if (input.checked) {
                            return input.value;
                        }
                    }
                }
                
                return null;
            },

            checkAnswer(question, userAnswer) {
                if (userAnswer === null) return false;
                
                if (question.type === 'multiple_choice') {
                    return userAnswer === question.correct;
                } else if (question.type === 'true_false') {
                    return userAnswer === question.correct;
                } else if (question.type === 'gap_filling') {
                    return userAnswer === question.correct;
                }
                
                return false;
            },

            showQuizResults() {
                const totalQuestions = vocabularyQuiz.questions.length;
                const percentage = Math.round((this.quizScore / totalQuestions) * 100);
                
                const resultsDiv = document.getElementById('vocab-results');
                const scoreDiv = document.getElementById('vocab-score');
                const feedbackDiv = document.getElementById('vocab-feedback');
                
                scoreDiv.textContent = `Score: ${this.quizScore}/${totalQuestions} (${percentage}%)`;
                
                let feedback = '';
                if (percentage >= 90) {
                    feedback = 'Excellent! You have a strong understanding of the vocabulary.';
                } else if (percentage >= 80) {
                    feedback = 'Very good! You understand most of the vocabulary well.';
                } else if (percentage >= 70) {
                    feedback = 'Good job! You have a solid grasp of the vocabulary.';
                } else if (percentage >= 60) {
                    feedback = 'Not bad! Review the explanations to improve your understanding.';
                } else {
                    feedback = 'Keep studying! Review the vocabulary words and their meanings.';
                }
                
                feedbackDiv.textContent = feedback;
                resultsDiv.classList.remove('hidden');
                
                // Hide question container
                document.getElementById('question-container').innerHTML = '';
                
                // Scroll to results
                resultsDiv.scrollIntoView({ behavior: 'smooth' });
            },

            addCheckAnswersButton() {
                // Remove existing check buttons if any
                const existingBtns = document.querySelectorAll('.check-section-btn, .check-exercise-btn');
                existingBtns.forEach(btn => btn.remove());
                
                const sectionKey = `${this.currentTab}_${this.currentSection}`;
                
                if (this.currentTab === 'listening') {
                    // For listening, add single button to left pane
                    const isChecked = this.answersChecked[sectionKey];
                    const button = document.createElement('div');
                    button.className = 'mt-6 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 text-center';
                    button.innerHTML = `
                        <button class="check-section-btn bg-blue-600 text-white font-bold py-3 px-8 rounded-md hover:bg-blue-700 transition-colors" data-section="${sectionKey}">
                            ${isChecked ? 'Reset Answers' : 'Check Answers'}
                        </button>
                        <p class="text-sm text-gray-600 mt-2">Check your answers for this section</p>
                    `;
                    this.leftPane.appendChild(button);
                } else {
                    // For reading, add separate buttons for each exercise type
                    this.addReadingExerciseButtons(sectionKey);
                }
            },

            addReadingExerciseButtons(sectionKey) {
                const exerciseTypes = this.getReadingExerciseTypes();
                
                // Remove any existing exercise buttons first to prevent duplicates
                exerciseTypes.forEach(exercise => {
                    const exerciseKey = `${sectionKey}_${exercise.type}`;
                    const existingButton = document.getElementById(`exercise-button-${exerciseKey}`);
                    if (existingButton) {
                        existingButton.remove();
                    }
                });
                
                exerciseTypes.forEach(exercise => {
                    const exerciseKey = `${sectionKey}_${exercise.type}`;
                    const isChecked = this.answersChecked[exerciseKey];
                    const buttonText = isChecked ? 'Reset Answers' : 'Check Answers';
                    
                    
                    const button = document.createElement('div');
                    button.className = 'mt-4 p-3 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 text-center';
                    button.id = `exercise-button-${exerciseKey}`;
                    button.innerHTML = `
                        <button class="check-exercise-btn bg-green-600 text-white font-bold py-2 px-6 rounded-md hover:bg-green-700 transition-colors" data-exercise="${exerciseKey}" data-range="${exercise.startQ}-${exercise.endQ}">
                            ${buttonText}
                        </button>
                        <p class="text-sm text-gray-600 mt-1">${exercise.title} (Q${exercise.startQ}-${exercise.endQ})</p>
                    `;
                    
                    // Insert button after the exercise's last question
                    let lastQuestion = document.getElementById(`q${exercise.endQ}`);
                    if (!lastQuestion) {
                        lastQuestion = document.querySelector(`input[name="q${exercise.endQ}"]`);
                    }
                    
                    if (lastQuestion) {
                        const parent = lastQuestion.closest('.space-y-3, .space-y-4');
                        if (parent) {
                            parent.appendChild(button);
                        }
                    }
                });
            },


            getReadingExerciseTypes() {
                // Define exercise types for each reading section
                const exerciseTypes = {
                    0: [ // Passage 1 - The Coconut Palm (Q41-53)
                        { type: 'table_completion', startQ: 41, endQ: 48, title: 'Table Completion (Q1-8)' },
                        { type: 'true_false', startQ: 49, endQ: 53, title: 'True/False/Not Given (Q9-13)' }
                    ],
                    1: [ // Passage 2 - How baby talk gives infant brains a boost (Q54-66)
                        { type: 'researcher_matching', startQ: 54, endQ: 57, title: 'Researcher Matching (Q14-17)' },
                        { type: 'summary_completion', startQ: 58, endQ: 63, title: 'Summary Completion (Q18-23)' },
                        { type: 'paragraph_matching', startQ: 64, endQ: 66, title: 'Paragraph Matching (Q24-26)' }
                    ],
                    2: [ // Passage 3 - Whatever happened to the Harappan Civilisation? (Q67-80)
                        { type: 'paragraph_matching_27_31', startQ: 67, endQ: 71, title: 'Paragraph Matching (Q27-31)' },
                        { type: 'summary_completion_32_37', startQ: 72, endQ: 77, title: 'Summary Completion (Q32-37)' },
                        { type: 'researcher_matching_38_40', startQ: 78, endQ: 80, title: 'Researcher Matching (Q38-40)' }
                    ]
                };
                
                return exerciseTypes[this.currentSection] || [];
            },
            
            showSectionAnswers(sectionKey) {
                // Get question range for current section
                let startQ, endQ;
                if (this.currentTab === 'listening') {
                    switch (this.currentSection) {
                        case 0: startQ = 1; endQ = 10; break;
                        case 1: startQ = 11; endQ = 20; break;
                        case 2: startQ = 21; endQ = 30; break;
                        case 3: startQ = 31; endQ = 40; break;
                    }
                } else {
                    switch (this.currentSection) {
                        case 0: startQ = 41; endQ = 53; break;
                        case 1: startQ = 54; endQ = 66; break;
                        case 2: startQ = 67; endQ = 80; break;
                    }
                }
                
                // Highlight correct/incorrect answers and add passage highlighting for reading
                for (let i = startQ; i <= endQ; i++) {
                    const qId = `q${i}`;
                    
                    // Try to find input by ID first (for text inputs), then by name (for radio buttons and checkboxes)
                    let input = document.getElementById(qId);
                    if (!input) {
                        // For radio buttons and checkboxes, find the selected ones
                        const radioButtons = document.querySelectorAll(`input[name="${qId}"]`);
                        if (radioButtons.length > 0) {
                            // Find the selected radio button or checked checkboxes
                            input = Array.from(radioButtons).find(radio => radio.checked);
                            if (!input) {
                                // If no radio button is selected, use the first one for styling
                                input = radioButtons[0];
                            }
                        }
                    }
                    
                    if (input) {
                        const userAnswer = this.userAnswers[qId] || "";
                        const correctAnswer = answers[qId];
                        
                        // Handle different answer types
                        let isCorrect = false;
                        if (input.type === 'checkbox') {
                            // For checkboxes, check if user selected the correct combination
                            const userValues = userAnswer.split('/').map(v => v.trim().toLowerCase()).sort();
                            const correctValues = correctAnswer.split('/').map(v => v.trim().toLowerCase()).sort();
                            isCorrect = userValues.length === correctValues.length && 
                                       userValues.every((val, index) => val === correctValues[index]);
                        } else {
                            // For radio buttons and text inputs
                            isCorrect = correctAnswer.split('/').includes(userAnswer.toLowerCase().trim());
                        }
                        
                        if (isCorrect) {
                            input.style.backgroundColor = '#dcfce7';
                            input.style.borderColor = '#16a34a';
                            input.classList.add('correct-answer');
                        } else {
                            input.style.backgroundColor = '#fef2f2';
                            input.style.borderColor = '#dc2626';
                            input.classList.add('incorrect-answer');
                        }
                        
                        // Add correct answer as placeholder (only for text inputs)
                        if (input.type === 'text' && !isCorrect && correctAnswer) {
                            input.placeholder = `Correct: ${correctAnswer}`;
                        }
                        
                        // For radio buttons and checkboxes, highlight the correct option
                        if ((input.type === 'radio' || input.type === 'checkbox') && correctAnswer) {
                            const correctOptions = correctAnswer.split('/');
                            correctOptions.forEach(option => {
                                const correctInput = document.querySelector(`input[name="${qId}"][value="${option.trim()}"]`);
                                if (correctInput) {
                                    correctInput.style.backgroundColor = '#dcfce7';
                                    correctInput.style.borderColor = '#16a34a';
                                    correctInput.classList.add('correct-answer');
                                }
                            });
                        }
                        
                        // Add explanation for reading questions
                        if (this.currentTab === 'reading' && readingExplanations[qId]) {
                            const explanation = readingExplanations[qId];
                            const explanationBox = document.createElement('div');
                            explanationBox.className = 'explanation-box mt-2 p-3 bg-blue-50 border-l-4 border-blue-400 rounded-r-md';
                            explanationBox.innerHTML = `
                                <div class="flex items-start">
                                    <div class="flex-shrink-0">
                                        <svg class="h-5 w-5 text-blue-400 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                        </svg>
                                    </div>
                                    <div class="ml-3 flex-1">
                                        <p class="text-sm text-blue-800">
                                            <strong>Explanation:</strong> ${explanation}
                                        </p>
                                        <p class="text-xs text-blue-600 mt-1 italic">Click to remove this explanation</p>
                                    </div>
                                </div>
                            `;
                            
                            // Insert explanation after the input's parent element
                            const parent = input.closest('.q-item, .space-y-3, .space-y-4');
                            if (parent) {
                                parent.appendChild(explanationBox);
                            }
                        }
                    }
                }
                
                // Update button text
                const btn = document.querySelector('.check-section-btn');
                if (btn) {
                    btn.textContent = 'Reset Answers';
                    btn.className = 'check-section-btn bg-gray-600 text-white font-bold py-3 px-8 rounded-md hover:bg-gray-700 transition-colors';
                }
            },

            showExerciseAnswers(exerciseKey, range) {
                // Parse the range (e.g., "67-71")
                const [startQ, endQ] = range.split('-').map(Number);
                
                // Highlight correct/incorrect answers and add explanations for reading
                for (let i = startQ; i <= endQ; i++) {
                    const qId = `q${i}`;
                    
                    // Try to find input by ID first (for text inputs), then by name (for radio buttons)
                    let input = document.getElementById(qId);
                    if (!input) {
                        // For radio buttons, find the selected one
                        const radioButtons = document.querySelectorAll(`input[name="${qId}"]`);
                        if (radioButtons.length > 0) {
                            // Find the selected radio button
                            input = Array.from(radioButtons).find(radio => radio.checked);
                            if (!input) {
                                // If no radio button is selected, use the first one for styling
                                input = radioButtons[0];
                            }
                        }
                    }
                    
                    if (input) {
                        const userAnswer = this.userAnswers[qId] || "";
                        const correctAnswer = answers[qId];
                        const isCorrect = correctAnswer.split('/').includes(userAnswer.toLowerCase().trim());
                        
                        if (isCorrect) {
                            input.style.backgroundColor = '#dcfce7';
                            input.style.borderColor = '#16a34a';
                            input.classList.add('correct-answer');
                        } else {
                            input.style.backgroundColor = '#fef2f2';
                            input.style.borderColor = '#dc2626';
                            input.classList.add('incorrect-answer');
                        }
                        
                        // Add correct answer as placeholder (only for text inputs)
                        if (input.type === 'text' && !isCorrect && correctAnswer) {
                            input.placeholder = `Correct: ${correctAnswer}`;
                        }
                        
                        // For radio buttons, highlight the correct option
                        if (input.type === 'radio') {
                            const correctRadio = document.querySelector(`input[name="${qId}"][value="${correctAnswer}"]`);
                            if (correctRadio) {
                                correctRadio.style.backgroundColor = '#dcfce7';
                                correctRadio.style.borderColor = '#16a34a';
                                correctRadio.classList.add('correct-answer');
                            }
                        }
                        
                        // Add explanation for reading questions
                        if (this.currentTab === 'reading' && readingExplanations[qId]) {
                            const explanation = readingExplanations[qId];
                            const explanationBox = document.createElement('div');
                            explanationBox.className = 'explanation-box mt-2 p-3 bg-blue-50 border-l-4 border-blue-400 rounded-r-md';
                            explanationBox.innerHTML = `
                                <div class="flex items-start">
                                    <div class="flex-shrink-0">
                                        <svg class="h-5 w-5 text-blue-400 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                        </svg>
                                    </div>
                                    <div class="ml-3 flex-1">
                                        <p class="text-sm text-blue-800">
                                            <strong>Explanation:</strong> ${explanation}
                                        </p>
                                        <p class="text-xs text-blue-600 mt-1 italic">Click to remove this explanation</p>
                                    </div>
                                </div>
                            `;
                            
                            // Insert explanation after the input's parent element
                            const parent = input.closest('.q-item, .space-y-3, .space-y-4');
                            if (parent) {
                                parent.appendChild(explanationBox);
                            }
                        }
                    }
                }
                
                // Update button text
                const btn = document.querySelector(`[data-exercise="${exerciseKey}"]`);
                if (btn) {
                    btn.textContent = 'Reset Answers';
                    btn.className = 'check-exercise-btn bg-gray-600 text-white font-bold py-2 px-6 rounded-md hover:bg-gray-700 transition-colors';
                }
            },

            calculateScore(userAnswers, startQ, endQ) {
                let score = 0;
                for (let i = startQ; i <= endQ; i++) {
                    const qId = `q${i}`;
                    const correctAnswers = answers[qId].split('/');
                    if (userAnswers[qId] && correctAnswers.includes(userAnswers[qId].toLowerCase().trim())) {
                        score++;
                    }
                }
                return score;
            },

            getListeningBandScore(score) {
                if (score >= 39) return 9.0;
                if (score >= 37) return 8.5;
                if (score >= 35) return 8.0;
                if (score >= 32) return 7.5;
                if (score >= 30) return 7.0;
                if (score >= 26) return 6.5;
                if (score >= 23) return 6.0;
                if (score >= 18) return 5.5;
                if (score >= 16) return 5.0;
                if (score >= 13) return 4.5;
                if (score >= 10) return 4.0;
                if (score >= 6) return 3.5;
                if (score >= 4) return 3.0;
                if (score >= 2) return 2.5;
                return 0;
            },

            getReadingBandScore(score) {
                if (score >= 39) return 9.0;
                if (score >= 37) return 8.5;
                if (score >= 35) return 8.0;
                if (score >= 33) return 7.5;
                if (score >= 30) return 7.0;
                if (score >= 27) return 6.5;
                if (score >= 23) return 6.0;
                if (score >= 19) return 5.5;
                if (score >= 15) return 5.0;
                if (score >= 13) return 4.5;
                if (score >= 10) return 4.0;
                if (score >= 8) return 3.5;
                if (score >= 6) return 3.0;
                if (score >= 4) return 2.5;
                return 0;
            },


            initSplitter() {
                let isDragging = false;

                // Main splitter (between left and right panes)
                this.splitter.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    isDragging = true;
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    e.preventDefault();
                    const containerRect = this.contentPanes.getBoundingClientRect();
                    const newLeftWidth = e.clientX - containerRect.left;
                    if (newLeftWidth > 100 && newLeftWidth < containerRect.width - 100) {
                        const newLeftPercent = (newLeftWidth / containerRect.width) * 100;
                        this.contentPanes.style.gridTemplateColumns = `${newLeftPercent}% 5px 1fr`;
                    }
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                });
            },
            
            initHighlighter() {
                document.body.addEventListener('mouseup', (e) => {
                    const selection = window.getSelection();
                    const selectedText = selection.toString().trim();

                    if (selectedText.length > 0) {
                        const range = selection.getRangeAt(0);
                        if (!this.leftPane.contains(range.commonAncestorContainer) && !this.rightPane.contains(range.commonAncestorContainer)) {
                           this.highlightTooltip.style.display = 'none';
                           return;
                        }

                        const rect = range.getBoundingClientRect();
                        this.highlightTooltip.style.left = `${e.pageX}px`;
                        this.highlightTooltip.style.top = `${e.pageY - 30}px`;
                        this.highlightTooltip.style.display = 'block';

                        this.highlightTooltip.onclick = () => {
                            const container = range.commonAncestorContainer;
                            if (container.nodeType === 3) { 
                                if (range.startContainer.parentElement !== range.endContainer.parentElement) {
                                    this.highlightTooltip.style.display = 'none';
                                    return;
                                }
                            }
                            
                            const mark = document.createElement('mark');
                            try {
                                range.surroundContents(mark);
                            } catch (ex) {
                                // Ignore error
                            } finally {
                                selection.removeAllRanges();
                                this.highlightTooltip.style.display = 'none';
                            }
                        };
                    } else {
                        this.highlightTooltip.style.display = 'none';
                    }
                });

                document.body.addEventListener('mousedown', (e) => {
                   if (e.target !== this.highlightTooltip && window.getSelection().toString().length === 0) {
                        this.highlightTooltip.style.display = 'none';
                   }
                });
            }
        };

        app.init();
    });
</script>

</body>
</html>
